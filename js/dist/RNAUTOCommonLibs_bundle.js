rndefine("#RNAUTOCommonLibs",["#RNAUTOCore/StoreBase","#RNAUTOCoreUI/ModelBase","#RNAUTOCoreUI/ToastService","lit/decorators","lit","#RNAUTOTextEditor/ImageNode","#RNAUTOTextEditor/FieldNode","#RNAUTOCore/LitElementBase","#RNAUTOTextEditor/SchemaBase","#RNAUTOTextEditor/MenuItem","#RNAUTODialog/Dialog","#RNAUTODialog/DialogBase","#RNAUTOTextEditor/DropDownMenuItem","#RNAUTOLit/Lit","#RNAUTOCoreUI/LitModel","#RNAUTOCoreUI/ModelWithParent","lit/directives/ref.js","lit-html/directives/live.js","#RNAUTOCore/Sanitizer","lit/directives/repeat.js","#RNAUTOCore/WpAjaxPost","#RNAUTOTextEditor/ButtonMenuItem","#RNAUTOTextEditor/TextEditorUtilities","#RNAUTOCore/SingleEvent","#RNAUTOCore/EventManager","#RNAUTOTextEditor/SingleLineCollection","#RNAUTOInputs/InputBase","#RNAUTOTabs/RNTabItem"],(function(e,t,i,n,o,s,a,r,l,d,p,u,h,c,m,f,y,C,g,b,v,O,w,S,I,T,x,$){"use strict";var V,N,A;let E=(V=e.StoreAutoIncrement("ActionId"),N=class extends e.StoreBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Id",A,this)}LoadDefaultValues(){this.Type="",this.Id=0}},A=babelHelpers.applyDecoratedDescriptor(N.prototype,"Id",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N);var G,D,L,P,R,F,M,z,B,U,H,_,k,q,j,W;let X;!function(e){e.Fixed="Fixed",e.Field="Field",e.Multiple="Multiple",e.Custom="Custom"}(X||(X={}));class Q extends e.StoreBase{LoadDefaultValues(){this.Value="",this.Email=""}}let J=(G=e.StoreDataType(Q),D=class extends e.StoreBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"EmailMapping",L,this)}LoadDefaultValues(){this.Value="",this.Type=X.Fixed,this.EmailMapping=[]}},L=babelHelpers.applyDecoratedDescriptor(D.prototype,"EmailMapping",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D),Y=(P=e.StoreDataType(Object),R=e.StoreDataType(J),F=e.StoreDataType(J),M=e.StoreDataType(J),z=e.StoreDataType(J),B=e.StoreDataType(Object),U=class extends E{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Email",H,this),babelHelpers.initializerDefineProperty(this,"To",_,this),babelHelpers.initializerDefineProperty(this,"ReplyTo",k,this),babelHelpers.initializerDefineProperty(this,"CC",q,this),babelHelpers.initializerDefineProperty(this,"BCC",j,this),babelHelpers.initializerDefineProperty(this,"Subject",W,this)}LoadDefaultValues(){super.LoadDefaultValues(),this.Type="send_email",this.To=[],this.ReplyTo=[],this.CC=[],this.BCC=[],this.Subject=null,this.FromName="",this.FromEmailAddress="",this.Email=null}},H=babelHelpers.applyDecoratedDescriptor(U.prototype,"Email",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=babelHelpers.applyDecoratedDescriptor(U.prototype,"To",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=babelHelpers.applyDecoratedDescriptor(U.prototype,"ReplyTo",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=babelHelpers.applyDecoratedDescriptor(U.prototype,"CC",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=babelHelpers.applyDecoratedDescriptor(U.prototype,"BCC",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=babelHelpers.applyDecoratedDescriptor(U.prototype,"Subject",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U);var K,Z,ee,te,ie,ne,oe,se;let ae=(K=e.StoreAutoIncrement("EditEntry"),Z=e.StoreDataType(Object),ee=class extends e.StoreBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Id",te,this),babelHelpers.initializerDefineProperty(this,"Value",ie,this)}LoadDefaultValues(){this.Id=0,this.FieldId="",this.Value=null,this.ValueType=""}},te=babelHelpers.applyDecoratedDescriptor(ee.prototype,"Id",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=babelHelpers.applyDecoratedDescriptor(ee.prototype,"Value",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee),re=(ne=e.StoreDataType(ae),oe=class extends E{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"FieldsToEdit",se,this)}LoadDefaultValues(){super.LoadDefaultValues(),this.FieldsToEdit=[],this.Type="update_entry"}},se=babelHelpers.applyDecoratedDescriptor(oe.prototype,"FieldsToEdit",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oe);class le extends E{LoadDefaultValues(){super.LoadDefaultValues(),this.Status="completed",this.Type="change_status"}}class de extends t.ModelBase{constructor(e,t){super(e),this.AutomationBuilder=t,this.AutomationContainer=t}GetAdditionalSettingSections(){return[]}GetSettings(){return[]}CreateSetting(e,t){return t.SetOptionsOverwrite(this.Options),{Label:e,Item:t}}Remove(){let e=this.AutomationContainer.Actions.indexOf(this);1!=this.AutomationContainer.Actions.length?e>=0&&(this.AutomationContainer.Actions.splice(e,1),this.AutomationContainer.Refresh()):i.ToastService.SendErrorMessage("You should have at least one action")}InitializeOptionsForFirstTime(){}}class pe extends r.LitElementBase{disconnectedCallback(){super.disconnectedCallback(),this.model.OnRefresh.Unsubscribe(this)}connectedCallback(){super.connectedCallback(),this.model.OnRefresh.Subscribe(this,(()=>this.forceUpdate()))}GetParentClasses(){return"PropertyItem"}GetLabel(){return o.html`<label style="font-weight: bold">${this.model.Label}</label>`}render(){return o.html` <div style="margin-bottom: 3px" class="propertySetting ${this.model.AdditionalClasses}"> ${this.GetLabel()} ${this.SubRender()} </div> `}}var ue={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="plus",i=[10133,61543,"add"],n="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z";e.definition={prefix:"fas",iconName:t,icon:[448,512,i,"2b",n]},e.faPlus=e.definition,e.prefix="fas",e.iconName=t,e.width=448,e.height=512,e.ligatures=i,e.unicode="2b",e.svgPathData=n,e.aliases=i}(ue);class he extends e.StoreBase{LoadDefaultValues(){this.Id=""}}class ce extends he{LoadDefaultValues(){super.LoadDefaultValues(),this.Id="field_summary",this.Format="one_row_per_field"}}class me extends class{CreateDefaultOptions(){return this.GetOptions().Merge()}}{GetOptions(){return new ce}}var fe=[{Id:"field_summary",Label:"Field Summary"}];n.customElement("rn-email-template-dialog")(class extends u.DialogBase{InternalGetOptions(){return{Title:"Please select a template",Styles:{width:"500px",maxWidth:"80%"}}}SubRender(){return o.html` <ul style="border: 1px solid #dfdfdf !important;"> ${fe.map((e=>o.html` <li @click="${()=>this.SendResult(e.Id)}" class="serverItem" value="${e.Id}">${e.Label}</li> `))} </ul> `}});var ye=[{Id:"field_summary",Label:"Field Summary"}];class Ce extends l.SchemaBase{constructor(){super()}GetNodes(){return{template:{inline:!1,attrs:{Options:{}},group:"block",draggable:!1,parseDOM:[{tag:"img",getAttrs:e=>({options:e.getAttribute("data-options")})}],toDOM:e=>{let t="Unknown Template";try{let i=JSON.parse(e.attrs.Options),n=ye.find((e=>e.Id==i.Id));null!=n&&(t=n.Label)}catch(e){}return o.renderInline(o.html`<div style="padding:0 2px;border: 1px solid #999;display: inline-block;background-color: #efefef">${t}</div>`)}}}}GetMenuItems(){return[new d.MenuItem({title:"Template",render:()=>o.renderInline(o.html`<div style="cursor:pointer;display: flex;align-items: center;" title="Insert Image"><rn-fontawesome style="margin-right: 3px;font-size: 16px" .icon="${ue.faPlus}"></rn-fontawesome>Template</div>`),enable:function(e){return!0},run:async(e,t,i)=>{let n=await p.Dialog.Show(o.html`<rn-email-template-dialog></rn-email-template-dialog>`);if(null==n)return;let s=class{static GetTemplate(e){switch(e){case"field_summary":return new me}}}.GetTemplate(n);null!=s&&(i.dispatch(i.state.tr.replaceSelectionWith(e.doc.type.schema.nodes.template.createAndFill({Options:JSON.stringify(s.CreateDefaultOptions().ToObject())}))),i.focus())}}),new h.DropDownMenuItem("Format","Options.Format").SetIsSubMenu().AddOption("One row per field","one_row_per_field").SetSelectOnlyNode("template")]}}c.customElementOnce("rnwppages-condition-builder")(class extends m.LitModel{NoFilterMessage(){return o.html` <div style="text-align: center"> <p style="margin:0">You haven't created any condition yet which means the trigger will be always executed without restrictions</p> <button @click=${()=>this.model.CreateGroup()} class='rnbtn rnbtn-primary' style="margin-top: 5px;display: inline-flex;align-items: center;"> <rn-fontawesome .icon=${ue.faPlus} style="margin-right: 3px"></rn-fontawesome> Click here to add your first filter </button> </div> `}render(){return 0==this.model.Groups.length?this.NoFilterMessage():o.html` <div> <span style="font-weight: bold">${this.model.Label}</span> ${this.model.Groups.map(((e,t)=>o.html` <div style="margin-bottom: 10px"> ${e.render((()=>{}),(()=>this.RemoveGroup(e)))} ${t<this.model.Groups.length-1?o.html`<span style="font-weight: bold">${RNTranslate("or")}</span>`:null} </div> `))} <div style="margin-top: 10px"> ${c.rnIf(this.model.Groups.length>0&&o.html` <label style="font-weight: bold">${RNTranslate("or")}</label> `)} <div style="margin-top: 10px"> <button @click=${e=>{e.preventDefault(),this.model.CreateGroup()}} class='rnbtn rnbtn-primary'>${RNTranslate("Add new group")}</button> </div> </div> </div> `}get Options(){return this.model.Options}RemoveGroup(e){let t=this.model.Groups.indexOf(e);t<0||(this.model.Options.ConditionGroups.splice(t,1),this.model.Groups.splice(t,1),this.forceUpdate())}});var ge={},be={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="xmark",i=[128473,10005,10006,10060,215,"close","multiply","remove","times"],n="f00d",o="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z";e.definition={prefix:"fas",iconName:t,icon:[320,512,i,n,o]},e.faXmark=e.definition,e.prefix="fas",e.iconName=t,e.width=320,e.height=512,e.ligatures=i,e.unicode=n,e.svgPathData=o,e.aliases=i}(be),function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=be;e.definition={prefix:t.prefix,iconName:t.iconName,icon:[t.width,t.height,t.aliases,t.unicode,t.svgPathData]},e.faTimes=e.definition,e.prefix=t.prefix,e.iconName=t.iconName,e.width=t.width,e.height=t.height,e.ligatures=t.aliases,e.unicode=t.unicode,e.svgPathData=t.svgPathData,e.aliases=t.aliases}(ge);var ve={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="trash",i=[],n="f1f8",o="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z";e.definition={prefix:"fas",iconName:t,icon:[448,512,i,n,o]},e.faTrash=e.definition,e.prefix="fas",e.iconName=t,e.width=448,e.height=512,e.ligatures=i,e.unicode=n,e.svgPathData=o,e.aliases=i}(ve);var Oe,we,Se,Ie,Te,xe,$e,Ve={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="link",i=[128279,"chain"],n="f0c1",o="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z";e.definition={prefix:"fas",iconName:t,icon:[640,512,i,n,o]},e.faLink=e.definition,e.prefix="fas",e.iconName=t,e.width=640,e.height=512,e.ligatures=i,e.unicode=n,e.svgPathData=o,e.aliases=i}(Ve);let Ne=(Oe=e.StoreDataType(Object),we=e.StoreDataType(Object),Se=e.StoreAutoIncrement("ConditionLineOptions"),Ie=class extends e.StoreBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Value",Te,this),babelHelpers.initializerDefineProperty(this,"AdditionalOptions",xe,this),babelHelpers.initializerDefineProperty(this,"Id",$e,this)}LoadDefaultValues(){this.Id=0,this.HasMapping=!1,this.FieldId="",this.Comparison=qe.None,this.Value="",this.Type=ke.None,this.SubType=He.None,this.PathId="",this.Column="",this.AdditionalOptions=null}GetValueFromLoader(e,t){switch(e){case"Value":return class{static GetValue(e,t){return e.SubType!=He.Multiple||""!=t&&Array.isArray(t)?t:[]}}.GetValue(this,t);default:return t}}},Te=babelHelpers.applyDecoratedDescriptor(Ie.prototype,"Value",[Oe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xe=babelHelpers.applyDecoratedDescriptor(Ie.prototype,"AdditionalOptions",[we],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$e=babelHelpers.applyDecoratedDescriptor(Ie.prototype,"Id",[Se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ie);var Ae,Ee,Ge,De,Le;let Pe=(Ae=e.StoreAutoIncrement("ConditionGroupOptions"),Ee=e.StoreDataType(Ne),Ge=class extends e.StoreBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Id",De,this),babelHelpers.initializerDefineProperty(this,"ConditionLines",Le,this)}LoadDefaultValues(){this.ConditionLines=[],this.Id=0}},De=babelHelpers.applyDecoratedDescriptor(Ge.prototype,"Id",[Ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le=babelHelpers.applyDecoratedDescriptor(Ge.prototype,"ConditionLines",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ge);var Re,Fe,Me,ze,Be;let Ue,He,_e,ke,qe;!function(e){e.Filter="Filter"}(Ue||(Ue={})),function(e){e.List="List",e.DateTime="DateTime",e.Date="Date",e.FileUpload="FileUpload",e.Multiple="Multiple",e.Number="Number",e.Rating="Rating",e.Text="Text",e.Time="Time",e.Toggle="Toggle",e.User="User",e.EntryId="EntryId",e.Composed="Composed",e.Signature="Signature",e.None="None",e.HTML="HTML",e.Currency="Currency",e.CurrencyMultiple="CurrencyMultiple",e.LikertScale="LikertScale"}(He||(He={})),function(e){e.Field="Field"}(_e||(_e={})),function(e){e.Standard="Standard",e.None="None",e.Advanced="Advanced"}(ke||(ke={})),function(e){e.Equal="Equal",e.NotEqual="NotEqual",e.IsEmpty="IsEmpty",e.IsNotEmpty="IsNotEmpty",e.None="None",e.UserViewingThePage="UserViewingThePage",e.LastXEntries="LastXEntries",e.LastXEntriesByUser="LastXEntriesByUser",e.Contains="Contains",e.UserIs="UserIs",e.UserIsNot="UserIsNot",e.HasRole="HasRole",e.HasNotRole="HasNotRole",e.NotContains="NotContains",e.GreaterThan="GreaterThan",e.GreaterOrEqualThan="GreaterOrEqualThan",e.LessThan="LessThan",e.LessOrEqualThan="LessOrEqualThan",e.IsChecked="IsChecked",e.IsNotChecked="IsNotChecked",e.IsViewed="IsViewed",e.IsNotViewed="IsNotViewed",e.IsStarred="IsStarred",e.IsNotStared="IsNotStared",e.IsGuest="IsGuest",e.IsNotGuest="IsNotGuest"}(qe||(qe={}));let je=(Re=e.StoreAutoIncrement("ConditionBaseOptions"),Fe=e.StoreDataType(Pe),Me=class extends e.StoreBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Id",ze,this),babelHelpers.initializerDefineProperty(this,"ConditionGroups",Be,this)}LoadDefaultValues(){this.Id=0,this.Type=Ue.Filter,this.ConditionGroups=[]}},ze=babelHelpers.applyDecoratedDescriptor(Me.prototype,"Id",[Re],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Be=babelHelpers.applyDecoratedDescriptor(Me.prototype,"ConditionGroups",[Fe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me);class We extends r.LitElementBase{}n.customElement("rn-x-time-submitting-this-form-input")(class extends We{render(){return o.html`<input type="number" style="height: 25px;width: 100%" placeholder="Number of times" .value="${C.live(this.condition.Options.Value)}" @change="${e=>{this.condition.Options.Value=e.target.Value}}"/>`}});var Xe=[{Type:"HasSubmittedXTimes",Label:"Has submitted this form x times",AllowedFields:["__userId"],AllowedTriggers:["before_submit","form_submitted"]},{Type:"HasSubmittedXTimesMinimum",Label:"Has submitted this form a minimum of x times",AllowedFields:["__userId"],AllowedTriggers:["before_submit","form_submitted"]},{Type:"HasSubmittedXTimesMaximum",Label:"Has submitted this form a maximum of x times",AllowedFields:["__userId"],AllowedTriggers:["before_submit","form_submitted"]}];var Qe,Je=new class{GetSpecialConditionsByField(e,t){return Xe.filter((i=>i.AllowedTriggers.indexOf(e)>-1&&i.AllowedFields.indexOf(t)>-1))}MaybeGetSpecialConditionComparators(e){var t,i;let n=null===(t=rnAutomationBuilder)||void 0===t||null===(i=t.Trigger)||void 0===i?void 0:i.CurrentTrigger;return null==n?[]:this.GetSpecialConditionsByField(n.Options.Type,e.Options.FieldId).map((t=>o.html` <option ?selected="${e.Options.Comparison==t.Type}" .value=${t.Type}>${t.Label}</option> `))}HasSpecialCondition(e){return null!=Xe.find((t=>{var i,n;return t.AllowedTriggers.indexOf(null===(i=rnAutomationBuilder)||void 0===i||null===(n=i.Trigger)||void 0===n?void 0:n.CurrentTrigger.Options.Type)>-1&&t.AllowedFields.indexOf(e.Options.FieldId)>-1&&t.Type==e.Options.Comparison}))}GetSpecialConditionValueInput(e){let t=Xe.find((t=>{var i,n;return t.AllowedTriggers.indexOf(null===(i=rnAutomationBuilder)||void 0===i||null===(n=i.Trigger)||void 0===n?void 0:n.CurrentTrigger.Options.Type)>-1&&t.AllowedFields.indexOf(e.Options.FieldId)>-1&&t.Type==e.Options.Comparison}));if(null==t)return null;switch(t.Type){case"HasSubmittedXTimes":case"HasSubmittedXTimesMinimum":case"HasSubmittedXTimesMaximum":return o.html`<rn-x-time-submitting-this-form-input .condition="${e}"></rn-x-time-submitting-this-form-input>`}}MaybeInitializeValue(e){switch(e.Options.Comparison){case"HasSubmittedXTimes":case"HasSubmittedXTimesMinimum":case"HasSubmittedXTimesMaximum":e.Options.Value=1}}MaybeSanitizeValue(e){switch(e.Options.Comparison){case"HasSubmittedXTimes":case"HasSubmittedXTimesMinimum":case"HasSubmittedXTimesMaximum":e.Options.Value=g.Sanitizer.SanitizeNumber(e.Options.Value,1)}}};let Ye=c.customElementOnce("rnwppages-license-required")(Qe=class extends u.DialogBase{constructor(...e){super(...e),this.message=""}InternalGetOptions(){return{Title:"Full version required",ShowApplyButton:!0,ShowCloseButton:!0,CloseButtonTitle:"Close",ApplyButtonTitle:"Get Full Version"}}SubRender(){return o.html`${this.message}`}async OnApply(){return window.open("https://formwiz.rednao.com/downloads/automation-for-wpforms/"),!0}static IsValid(e="Sorry this feature is only available in the full version"){return"1"==rnBuilderVar.IsPR||(p.Dialog.Show(o.html`<rnwppages-license-required .message="${e}"></rnwppages-license-required>`),!1)}static AddFullVersionText(e){return""==rnBuilderVar.IsPR?e+" (Full version only)":e}})||Qe;var Ke=[{Type:"PreviousSubmissions",Label:Ye.AddFullVersionText("Previous submissions"),AllowedTriggers:["before_submit","form_submitted"]}];var Ze,et,tt,it=new class{GetSpecialConditionsByTrigger(e){return Ke.filter((t=>t.AllowedTriggers.indexOf(e)>-1))}};class nt{Initialize(e){return this.Condition=e,this.Condition.Options.Comparison==qe.None&&(this.Condition.Options.Column="",this.InitializeValues()),this}get ConditionField(){return this.Condition.Parent.Parent.GetFieldById(this.Condition.Options.FieldId)}Render(){var e,t,i,n,s;let a=null===(e=this.Condition.Parent.Parent.GetFields())||void 0===e?void 0:e.filter((e=>e.UseInConditions));if(null==a)return o.html` <p>Please select a form first</p> `;let r=this.Condition.Options.FieldId+"_"+this.Condition.Options.PathId;""==this.Condition.Options.PathId&&(r="");let l=Je.GetSpecialConditionValueInput(this.Condition);null==l&&(l=this.GetValueInput()),"Advanced"==this.Condition.Options.Type&&(r=this.Condition.Options.FieldId);let d=null===(t=rnAutomationBuilder)||void 0===t||null===(i=t.Trigger)||void 0===i||null===(n=i.CurrentTrigger)||void 0===n||null===(s=n.Options)||void 0===s?void 0:s.Type,p=it.GetSpecialConditionsByTrigger(d);return o.html` <div> <div class='conditionLine' style="display: flex;align-items: flex-start;margin-bottom: 5px;padding: 5px"> <div style="width:30%;" class='conditionColumn'> <select .value=${C.live(r)} style="height: auto;padding: 0;width: 100%" class=${""==r&&this.ShouldShowErrors()?"rnInvalidCondition":""} @change=${e=>this.FieldChanged(e.target.value,e.target[e.target.selectedIndex].getAttribute("data-linetype").toString(),e.target[e.target.selectedIndex])}> <option ?selected="${""==r}" value="" data-linetype=${ke.None.toString()}>${RNTranslate("Select a field")}</option> <optgroup .label=${RNTranslate("Fields")}> ${a.map((e=>e.GetDataSections("Filter").map(((t,i)=>o.html` <option ?selected="${r==e.Id+"_"+t.PathId}" data-path-id=${t.PathId} data-field-id=${e.Id} data-linetype=${ke.Standard.toString()} .value=${e.Id+"_"+t.PathId}>${(i>0?"    ":"")+t.Label}</option> `))))} </optgroup> ${c.rnIf(p.length>0&&o.html` <optgroup label="Advanced"> ${b.repeat(p,(e=>e.Type),(e=>o.html` <option ?selected="${this.Condition.Options.FieldId==e.Type}" data-linetype=${ke.Advanced.toString()} data-field-id=${e.Type} .value=${e.Type}>${e.Label}</option> `))} </optgroup> `)} </select> </div> <div style="width: ${null!=l?"20%":"calc(70% - 80px)"}" class=${"conditionColumn"}> ${this.GetComparator(!1)} </div> ${this.GetValueSection(l)} <div style="width:80px" class='conditionColumn'> <button @click=${e=>{e.preventDefault(),this.Condition.Instance.FireEvent("addLine",this.Condition,!0)}} class='rnbtn rnbtn-light' style="padding: 1px 5px;">${RNTranslate("AND")}</button> <span class='ConditionRemove' style="line-height: 25px;vertical-align: middle;cursor: pointer;" @click=${e=>{e.preventDefault(),this.Condition.Instance.FireEvent("removeLine",this.Condition,!0)}}> <rn-fontawesome .icon=${ge.faTimes} style="margin-left: 5px"/></span> </div> </div> </div> `}AllowFieldMapping(){return!0}GetValueSection(e){if(null==e)return null;let t=null;if(this.Condition.Parent.Parent.AllowFieldMapping()&&this.AllowFieldMapping())if(this.Condition.Options.HasMapping){t=o.html` <div @click="${()=>{this.Condition.Options.Value=null,this.Condition.Options.HasMapping=!1,this.Condition.Refresh()}}" class="removeMapping rnIcon" title="Remove mapping" style="height: 30px;width: 30px;display: flex;align-items: center;justify-content: center;"> <rn-fontawesome .icon="${ve.faTrash}"></rn-fontawesome> </div>`;let i="Unknown";null!=this.Condition.Options.Value.Id&&null!=this.Condition.Options.Value.Path&&(i=this.Condition.Parent.Parent.GetAutomationBuilder().DataSource.GetFriendlyName(this.Condition.Options.Value.Id,this.Condition.Options.Value.Path,!0,!0)),e=o.html`<input .value="${i}" type="text" style="height: 30px;width: 100%;" readonly/>`}else t=o.html`<div @click="${()=>this.MapField()}" class="mapToField rnIcon" title="Map to field" style="height: 30px;width: 30px;display: flex;align-items: center;justify-content: center;"><rn-fontawesome .icon="${Ve.faLink}"></rn-fontawesome></div>`;return o.html` <div style="display: flex; width: calc(50% - 80px)" class=${"conditionColumn"}> <div style="flex-grow: 1"> ${e} </div> ${t} </div> `}ShouldShowErrors(){return!1}FieldChanged(e,t,i){if(t==ke.Advanced&&!Ye.IsValid())return void this.Condition.Refresh();let n;if(this.Condition.Options.PathId="",ke[t]==ke.Standard){let e=i.getAttribute("data-field-id"),t=this.Condition.Parent.Parent.GetFieldById(e);n=null==t?He.None:t.Type,this.Condition.Options.FieldId=e,this.Condition.Options.PathId=i.getAttribute("data-path-id"),t.Type==He.Multiple?this.Condition.Options.Value=g.Sanitizer.SanitizeStringArray(this.Condition.Options.Value):this.Condition.Options.Value=g.Sanitizer.SanitizeString(this.Condition.Options.Value)}ke[t]==ke.None&&(this.Condition.Options.FieldId=""),this.Condition.Options.Comparison=qe.None,this.Condition.Options.Type=ke[t],this.Condition.Options.SubType=n,t==ke.Advanced&&(this.Condition.Options.FieldId=e,this.Condition.Options.Value=""),this.Condition.Instance.FireEvent("fieldChanged"),this.Condition.Refresh()}MaybeInitializeValue(){Je.MaybeInitializeValue(this.Condition)}SanitizeValue(){this.Condition.Options.Value=g.Sanitizer.SanitizeString(this.Condition.Options.Value)}ValueIsValid(){return this.Condition.Options.Comparison==qe.IsEmpty||this.Condition.Options.Comparison==qe.IsNotEmpty||""!=g.Sanitizer.SanitizeString(this.Condition.Options.Value)}ComparisonIsValid(){return this.Condition.Options.Comparison!=qe.None}GetValueClass(){return!this.ValueIsValid()&&this.Condition.ShowValidations?"rnInvalidCondition":""}GetComparisonClass(){return!this.ComparisonIsValid()&&this.Condition.Options?"rnInvalidCondition":""}Validate(){return""==this.Condition.Options.FieldId?(i.ToastService.SendErrorMessage("Please select a field"),this.Condition.ShowValidations=!0,!1):this.ComparisonIsValid()?this.ValueIsValid()?(this.Condition.ShowValidations=!1,!0):(i.ToastService.SendErrorMessage("Invalid Value"),this.Condition.ShowValidations=!0,!1):(i.ToastService.SendErrorMessage("Invalid Comparison"),this.Condition.ShowValidations=!0,!1)}async MapField(){if(""==this.Condition.Options.FieldId)return void i.ToastService.SendErrorMessage("Please select a field first");let e=this.Condition.Parent.Parent.GetFieldById(this.Condition.Options.FieldId);if(null==e)return void i.ToastService.SendErrorMessage("Selected field not found, please pick another field");let t=await p.Dialog.Show(o.html`<rn-field-dialog .allowedFieldSubType="${e.SubType}" .allowedFieldPath="${this.Condition.Options.PathId}" .AutomationBuilder="${this.Condition.Parent.Parent.GetAutomationBuilder()}"></rn-field-dialog>`);null!=t&&(this.Condition.Options.HasMapping=!0,this.Condition.Options.Value=t.Value,this.Condition.Refresh())}}class ot extends nt{GetComparator(){return o.html`<select style="width: 100%;height: auto;padding: 0" .disabled=${!0}/>`}GetValueInput(){return o.html`<input .value=${""} style="width:100%;height:25px" type=${"text"} ?disabled=${!0}/>`}InitializeValues(){}}class st extends nt{GetComparator(){return o.html` <select value=${this.Condition.Options.Comparison} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: 28px;padding: 0;width: 100%"> <option ?selected="${this.Condition.Options.Comparison==qe.Equal}" .value=${qe.Equal}>${RNTranslate("Equal to")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.NotEqual}" .value=${qe.NotEqual}>${RNTranslate("Not Equal to")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsEmpty}" .value=${qe.IsEmpty}>${RNTranslate("Is Empty")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsNotEmpty}" .value=${qe.IsNotEmpty}>${RNTranslate("Is Not Empty")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.Contains}" .value=${qe.Contains}>${RNTranslate("Contains")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.NotContains}" .value=${qe.NotContains}>${RNTranslate("Not Contains")}</option> </select> `}InitializeValues(){this.Condition.Options.Comparison=qe.Equal,this.Condition.Options.AdditionalOptions=null}GetValueInput(){let e=this.Condition.Options.Comparison;return o.html`<input value=${C.live(this.Condition.Options.Value)} @change=${e=>this.ValueChanged(e.target.value)} style="min-width: 100%;max-width: 200px;height: 30px;width: 100%;" type='text' ?disabled=${e==qe.IsEmpty||e==qe.IsNotEmpty}/>`}ComparisonChanged(e){this.Condition.Options.Comparison=qe[e],this.Condition.Refresh()}ValueChanged(e){this.Condition.Options.Value=e,this.Condition.Refresh()}}class at extends nt{GetComparator(e=!1){return this.ConditionField,o.html` <select class=${this.GetComparisonClass()} .value=${this.Condition.Options.Comparison} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: auto;padding: 0;width: 100%"> <option ?selected="${this.Condition.Options.Comparison==qe.Equal}" .value=${qe.Equal}>${RNTranslate("Equal to")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.NotEqual}" .value=${qe.NotEqual}>${RNTranslate("Not Equal to")}</option> ${c.rnIf(!e&&o.html`<option ?selected="${this.Condition.Options.Comparison==qe.IsEmpty}" .value=${qe.IsEmpty}>${RNTranslate("Is Empty")}</option>`)} ${c.rnIf(!e&&o.html`<option ?selected="${this.Condition.Options.Comparison==qe.IsNotEmpty}" .value=${qe.IsNotEmpty}>${RNTranslate("Is Not Empty")}</option>`)} <option ?selected="${this.Condition.Options.Comparison==qe.Contains}" .value=${qe.Contains}>${RNTranslate("Contains")}</option> </select> `}InitializeValues(){this.Condition.Options.Comparison=qe.Equal,this.Condition.Options.AdditionalOptions=null}GetValueInput(){let e=this.Condition.Options.Comparison;return o.html`<input class=${this.GetValueClass()} .value=${this.Condition.Options.Value} @change=${e=>this.ValueChanged(e.target.value)} style="min-width: 100%;max-width: 200px;height: 25px;width: 100%" type='text' ?disabled=${e==qe.IsEmpty||e==qe.IsNotEmpty}/>`}ComparisonChanged(e){this.Condition.Options.Comparison=qe[e],this.Condition.Refresh()}ValueChanged(e){this.Condition.Options.Value=e,this.Condition.Refresh()}}class rt{static UnixToDate(e,t=0){if(e>0){let i=new Date(1e3*(g.Sanitizer.SanitizeNumber(e)+t));return i=new Date(i.setMinutes(i.getMinutes()+i.getTimezoneOffset())),i}return null}static DateToUnix(e,t=0){return(e.getTime()-t)/1e3+-1*e.getTimezoneOffset()*60}}class lt extends nt{GetComparator(e=!1){return o.html` <select class=${this.GetComparisonClass()} .value=${C.live(this.Condition.Options.Comparison)} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: auto;padding: 0;width: 100%"> <option ?select="${this.Condition.Options.Comparison==qe.Equal}" .value=${qe.Equal}>${RNTranslate("Equal to")}</option> <option ?select="${this.Condition.Options.Comparison==qe.NotEqual}" .value=${qe.NotEqual}>${RNTranslate("Not Equal to")}</option> ${c.rnIf(!e&&o.html`<option ?select="${this.Condition.Options.Comparison==qe.IsEmpty}" .value=${qe.IsEmpty}>${RNTranslate("Is Empty")}</option>`)} ${c.rnIf(!e&&o.html`<option ?select="${this.Condition.Options.Comparison==qe.IsNotEmpty}" .value=${qe.IsNotEmpty}>${RNTranslate("Is Not Empty")}</option>`)} <option ?select="${this.Condition.Options.Comparison==qe.GreaterThan}" .value=${qe.GreaterThan}>${RNTranslate("Greater Than")}</option> <option ?select="${this.Condition.Options.Comparison==qe.GreaterOrEqualThan}" .value=${qe.GreaterOrEqualThan}>${RNTranslate("Greater or Equal Than")}</option> <option ?select="${this.Condition.Options.Comparison==qe.LessThan}" .value=${qe.LessThan}>${RNTranslate("Less Than")}</option> <option ?select="${this.Condition.Options.Comparison==qe.LessOrEqualThan}" .value=${qe.LessOrEqualThan}>${RNTranslate("Less or Equal Than")}</option> </select> `}InitializeValues(){this.Condition.Options.Value="",this.Condition.Options.Comparison=qe.Equal,this.Condition.Options.AdditionalOptions=null}IsPrefixedDate(){return["today","startofweek","endofweek","startofmonth","endofmonth","xDaysFromNow","xWeeksFromNow","xMonthsFromNow"].indexOf(this.Condition.Options.Value)>=0}GetValueInput(){let e="custom";return this.IsPrefixedDate()&&(e=this.Condition.Options.Value),this.Condition.Options.Comparison,o.html`<div style="display: flex"> <select .value="${e}" style="height: auto;width:100%;" @change="${e=>{this.Condition.Options.Value=e.target.value,this.Condition.Refresh()}}"> <option ?selected="${"custom"==e}" value="custom">Custom date</option> <option ?selected="${"today"==e}" value="today">Today</option> <option ?selected="${"startofweek"==e}" value="startofweek">Start of week</option> <option ?selected="${"endofweek"==e}" value="endofweek">End of week</option> <option ?selected="${"startofmonth"==e}" value="startofmonth">Start of month</option> <option ?selected="${"endofmonth"==e}" value="endofmonth">End of month</option> <option ?selected="${"xDaysFromNow"==e}" value="xDaysFromNow">X days from now</option> <option ?selected="${"xWeeksFromNow"==e}" value="xWeeksFromNow">X weeks from now</option> <option ?selected="${"xMonthsFromNow"==e}" value="xMonthsFromNow">X months from now</option> </select> ${this.GetDateSectionInput(e)}`}GetDateSectionInput(e){return["xDaysFromNow","xWeeksFromNow","xMonthsFromNow"].indexOf(e)>=0?o.html`<input type="number" style="width: 100%;height: auto;padding: 0 7px" placeholder="Quantity" @change="${e=>{this.Condition.Options.AdditionalOptions=e.target.value,this.Condition.Refresh()}}"/>`:o.html` <rn-inputs-datepicker ?disabled="${"custom"!=e}" className=${"condition-datepicker "+this.GetValueClass()} .enableTime=${!0} .value="${rt.UnixToDate(this.Condition.Options.Value)}" @change=${e=>this.ValueChanged(e)} .format="dd/MMM/yyyy h:mm aa" style="min-width: 150px;width:100%;height: 30px;margin:0;" type='text' ></rn-inputs-datepicker> `}ComparisonChanged(e){this.Condition.Options.Comparison=qe[e],this.Condition.Refresh()}ValueChanged(e){this.Condition.Options.Value=e.detail,this.Condition.Refresh()}}class dt extends nt{GetComparator(e=!1){return o.html` <select class=${this.GetComparisonClass()} .value=${this.Condition.Options.Comparison} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: auto;padding: 0;width: 100%"> <option ?selected="${this.Condition.Options.Comparison==qe.Equal}" .value=${qe.Equal}>${RNTranslate("Equal to")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.NotEqual}" .value=${qe.NotEqual}>${RNTranslate("Not Equal to")}</option> {!skipValueLessConditions&&<option ?selected="${this.Condition.Options.Comparison==qe.IsEmpty}" .value=${qe.IsEmpty}>${RNTranslate("Is Empty")}</option>} {!skipValueLessConditions&&<option ?selected="${this.Condition.Options.Comparison==qe.IsNotEmpty}" .value=${qe.IsNotEmpty}>${RNTranslate("Is Not Empty")}</option>} <option ?selected="${this.Condition.Options.Comparison==qe.GreaterThan}" .value=${qe.GreaterThan}>${RNTranslate("Greater Than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.GreaterOrEqualThan}" .value=${qe.GreaterOrEqualThan}>${RNTranslate("Greater or Equal Than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.LessThan}" .value=${qe.LessThan}>${RNTranslate("Less Than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.LessOrEqualThan}" .value=${qe.LessOrEqualThan}>${RNTranslate("Less or Equal Than")}</option> </select> `}InitializeValues(){this.Condition.Options.Value="",this.Condition.Options.AdditionalOptions=null,this.Condition.Options.Comparison=qe.Equal}IsPrefixedDate(){return["today","startofweek","endofweek","startofmonth","xDaysFromNow","xWeeksFromNow","xMonthsFromNow"].indexOf(this.Condition.Options.Value)>=0}GetValueInput(){let e="custom";return this.IsPrefixedDate()&&(e=this.Condition.Options.Value),this.Condition.Options.Comparison,o.html`<div style="display: flex"> <select .value="${e}" style="height: auto;width: 100%" @change="${e=>{this.Condition.Options.Value=e.target.value,this.Condition.Refresh()}}"> <option ?selected="${"custom"==e}" value="custom">Custom date</option> <option ?selected="${"today"==e}" value="today">Today</option> <option ?selected="${"startofweek"==e}" value="startofweek">Start of week</option> <option ?selected="${"endofweek"==e}" value="endofweek">End of week</option> <option ?selected="${"startofmonth"==e}" value="startofmonth">Start of month</option> <option ?selected="${"xDaysFromNow"==e}" value="xDaysFromNow">X days from now</option> <option ?selected="${"xWeeksFromNow"==e}" value="xWeeksFromNow">X weeks from now</option> <option ?selected="${"xMonthsFromNow"==e}" value="xMonthsFromNow">X months from now</option> </select> ${this.GetDateSectionInput(e)}`}ComparisonChanged(e){this.Condition.Options.Comparison=qe[e],this.Condition.Refresh()}ValueChanged(e){this.Condition.Options.Value=rt.DateToUnix(e),this.Condition.Refresh()}GetContainer(e){}GetDateSectionInput(e){return["xDaysFromNow","xWeeksFromNow","xMonthsFromNow"].indexOf(e)?o.html`<input type="text" style="width: 100%;height: auto;padding: 0 7px" placeholder="Quantity" .value="${C.live(this.Condition.Options.AdditionalOptions)}" @change="${e=>{this.Condition.Options.AdditionalOptions=e.target.value,this.Condition.Refresh()}}"/>`:o.html` <rn-inputs-datepicker ?disabled="${"custom"!=e}" class=${"condition-datepicker "+this.GetValueClass()} .format=${"dd/MMM/yyyy"} .value="${rt.UnixToDate(this.Condition.Options.Value)}" @change=${e=>this.ValueChanged(e)} style="min-width: 150px;width: 100%;height: 30px;margin:0;" /></div> `}}class pt extends nt{GetComparator(e=!1){return o.html` <select class=${this.GetComparisonClass()} .value=${this.Condition.Options.Comparison} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: auto;padding: 0;width: 100%"> <option ?selected="${this.Condition.Options.Comparison==qe.Equal}" .value=${qe.Equal}>${RNTranslate("Equal to")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.NotEqual}" .value=${qe.NotEqual}>${RNTranslate("Not Equal to")}</option> {!skipValueLessConditions&&<option ?selected="${this.Condition.Options.Comparison==qe.IsEmpty}" .value=${qe.IsEmpty}>${RNTranslate("Is Empty")}</option>} {!skipValueLessConditions&&<option ?selected="${this.Condition.Options.Comparison==qe.IsNotEmpty}" .value=${qe.IsNotEmpty}>${RNTranslate("Is Not Empty")}</option>} <option ?selected="${this.Condition.Options.Comparison==qe.GreaterThan}" .value=${qe.GreaterThan}>${RNTranslate("Greater Than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.GreaterOrEqualThan}" .value=${qe.GreaterOrEqualThan}>${RNTranslate("Greater or Equal Than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.LessThan}" .value=${qe.LessThan}>${RNTranslate("Less Than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.LessOrEqualThan}" .value=${qe.LessOrEqualThan}>${RNTranslate("Less or Equal Than")}</option> </select> `}InitializeValues(){this.Condition.Options.Comparison=qe.Equal,this.Condition.Options.AdditionalOptions=null}GetValueInput(){return this.Condition.Options.Comparison,o.html`<rn-inputs-datepicker class=${"condition-datepicker "+this.GetValueClass()} .format=${"dd/MMM/yyyy"} .value="${rt.UnixToDate(this.Condition.Options.Value)}" @change=${e=>this.ValueChanged(e)} style="min-width: 150px;width: 100%;height: 30px;margin:0;" />`}ComparisonChanged(e){this.Condition.Options.Comparison=qe[e],this.Condition.Refresh()}ValueChanged(e){this.Condition.Options.Value=rt.DateToUnix(e),this.Condition.Refresh()}}class ut extends e.StoreBase{constructor(...e){super(...e),this.IsPR=!1}get UseInConditions(){return!0}GetDataSections(e){return[{Id:this.Id,Label:this.Label+" (Id:"+this.Id+")",PathId:"Value",Path:["Value"]}]}get SupportArithmeticAggregation(){return[He.Number,He.CurrencyMultiple,He.Currency].indexOf(this.Type)>=0}LoadDefaultValues(){this.Id="",this.Label="",this.Type=He.None,this.SubType="",this.IsPR=!1}}class ht extends e.StoreBase{LoadDefaultValues(){this.Label="",this.Value="",this.Price=""}}let ct=(Ze=e.StoreDataType(ht),et=class extends ut{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Items",tt,this)}LoadDefaultValues(){super.LoadDefaultValues(),this.Items=[]}},tt=babelHelpers.applyDecoratedDescriptor(et.prototype,"Items",[Ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),et);class mt extends nt{GetComparator(){return o.html` <select .value=${this.Condition.Options.Comparison} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: 28px;padding: 0;width: 100%"> <option ?selected="${this.Condition.Options.Comparison==qe.Contains}" value=${qe.Contains}>${RNTranslate("Contains")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.NotContains}" value=${qe.NotContains}>${RNTranslate("Not Contains")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsEmpty}" value=${qe.IsEmpty}>${RNTranslate("Is Empty")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsNotEmpty}" value=${qe.IsNotEmpty}>${RNTranslate("Is Not Empty")}</option> </select> `}InitializeValues(){this.Condition.Options.Comparison=qe.Contains,this.Condition.Options.AdditionalOptions=null}GetValueInput(){if(this.Condition.Options.Comparison==qe.IsEmpty||this.Condition.Options.Comparison==qe.IsNotEmpty)return null;let e=this.GetAvailableOptions(),t=[];return Array.isArray(this.Condition.Options.Value)&&(t=e.filter((e=>this.Condition.Options.Value.indexOf(e.Value)>=0)).map((e=>e.Value))),o.html` <rn-inputs-select style="min-height: 30px;width: 100%" multiple .value="${t}" @change="${e=>this.OnChange(e.detail)}" .propertyName="${"Value"}" .options="${e}" ></rn-inputs-select> `}GetAvailableOptions(){let e=[];if(this.Condition.Options.Type==ke.Standard){let t=this.ConditionField;if(null==t||!(t instanceof ct))return e;for(let i of t.Items)e.push({Label:i.Label,Value:i.Value})}return e}SanitizeValue(){this.Condition.Options.Value=g.Sanitizer.SanitizeStringArray(this.Condition.Options.Value)}ComparisonChanged(e){this.Condition.Options.Comparison=qe[e],this.Condition.Refresh()}OnChange(e){this.Condition.Options.Value=e,this.Condition.Refresh()}}class ft extends nt{GetComparator(){return o.html` <select value=${this.Condition.Options.Comparison} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: 28px;padding: 0;width: 100%"> <option ?selected="${this.Condition.Options.Comparison==qe.Equal}" value=${qe.Equal}>${RNTranslate("Equal to")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.NotEqual}" value=${qe.NotEqual}>${RNTranslate("Not Equal to")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.GreaterThan}" value=${qe.GreaterThan}>${RNTranslate("Greater than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.GreaterOrEqualThan}" value=${qe.GreaterOrEqualThan}>${RNTranslate("Greater or equal than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.LessThan}" value=${qe.LessThan}>${RNTranslate("Less than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.LessOrEqualThan}" value=${qe.LessOrEqualThan}>${RNTranslate("Less or equal than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsEmpty}" value=${qe.IsEmpty}>${RNTranslate("Is Empty")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsNotEmpty}" value=${qe.IsNotEmpty}>${RNTranslate("Is Not Empty")}</option> </select> `}InitializeValues(){this.Condition.Options.Comparison=qe.Equal,this.Condition.Options.AdditionalOptions=null,this.Condition.Options.Value=g.Sanitizer.SanitizeNumber(this.Condition.Options.Value,"")}GetValueInput(){let e=this.Condition.Options.Comparison;return o.html`<input type="number" value=${C.live(this.Condition.Options.Value)} @change=${e=>this.ValueChanged(e.target.value)} style="min-width: 100%;max-width: 200px;height: 30px;width: 100%;" type='text' ?disabled=${e==qe.IsEmpty||e==qe.IsNotEmpty}/>`}ComparisonChanged(e){this.Condition.Options.Comparison=qe[e],this.Condition.Refresh()}ValueChanged(e){this.Condition.Options.Value=e,this.Condition.Refresh()}}class yt extends nt{GetComparator(e=!1){return o.html` <select class=${this.GetComparisonClass()} .value=${this.Condition.Options.Comparison} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: auto;padding: 0;width: 100%"> ${!e&&o.html`<option ?selected="${this.Condition.Options.Comparison==qe.IsChecked}" .value=${qe.IsChecked}>${RNTranslate("Is checked")}</option>`} ${!e&&o.html`<option ?selected="${this.Condition.Options.Comparison==qe.IsNotChecked}" .value=${qe.IsNotChecked}>${RNTranslate("Is not checked")}</option>`} </select> `}InitializeValues(){this.Condition.Options.Comparison=qe.Equal,this.Condition.Options.AdditionalOptions=null}GetValueInput(){let e=this.Condition.Options.Comparison;return o.html`<input class=${this.GetValueClass()} .value=${this.Condition.Options.Value} @change=${e=>this.ValueChanged(e.target.value)} style="min-width: 100%;max-width: 200px;height: 25px" type='text' ?disabled=${e==qe.IsEmpty||e==qe.IsNotEmpty}/>`}ComparisonChanged(e){this.Condition.Options.Comparison=qe[e],this.Condition.Refresh()}ValueChanged(e){this.Condition.Options.Value=e,this.Condition.Refresh()}}class Ct{constructor(){this._loadingUsers=null,this._loadingUsersQueue=[],this._cachedUsers=new Map}static GetInstance(){return null==Ct._Instance&&(Ct._Instance=new Ct),Ct._Instance}async GetUsersById(e){return this.MaybeLoadUsers(e)}GetUserList(){return Array.from(this._cachedUsers.values())}async MaybeLoadUsers(e){let t=[];for(let i of e)this._cachedUsers.has(i)||t.push(i);if(0==t.length)return!0;let i=await v.WpAjaxPost.Post("load_users_by_id",{Ids:t},"",null,{Prefix:rnBuilderVar._prefix,Nonce:rnBuilderVar._nonce});if(null==i)return!1;for(let e of i)this.AddUser(e.Value,e.Label);return e.forEach((e=>{this._cachedUsers.has(e)||this.AddUser(e,"Unknown")})),!0}HasAllUsers(e){for(let t of e)if(!this._cachedUsers.has(t))return!1;return!0}AddUser(e,t){this._cachedUsers.has(e)||this._cachedUsers.set(e,{Value:e,Label:t})}}class gt extends nt{constructor(){super(),this.LoadUsers=this.LoadUsers.bind(this)}GetComparator(e=!1){return o.html` <select class=${this.GetComparisonClass()} .value=${this.Condition.Options.Comparison} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: auto;padding: 0;width: 100%"> <option .value=${""}>Select an option</option> ${c.rnIf(!e&&o.html`<option ?selected="${this.Condition.Options.Comparison==qe.UserViewingThePage}" .value=${qe.UserViewingThePage}>${RNTranslate("User viewing the page")}</option>`)} <option ?selected="${this.Condition.Options.Comparison==qe.UserIs}" .value=${qe.UserIs}>${RNTranslate("Is")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.UserIsNot}" .value=${qe.UserIsNot}>${RNTranslate("Is not")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.HasRole}" .value=${qe.HasRole}>${RNTranslate("Have role")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.HasNotRole}" .value=${qe.HasNotRole}>${RNTranslate("Doesn't have role")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsGuest}" .value=${qe.IsGuest}>${RNTranslate("Is guest")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsNotGuest}" .value=${qe.IsNotGuest}>${RNTranslate("Is not guest")}</option> ${Je.MaybeGetSpecialConditionComparators(this.Condition)} </select> `}InitializeValues(){this.Condition.Options.Comparison=qe.None,this.Condition.Options.AdditionalOptions=null}AllowFieldMapping(){return!1}GetValueInput(){switch(this.Condition.Options,g.Sanitizer.SanitizeStringArray(this.Condition.Options.Value),this.Condition.Options.Comparison){case qe.UserViewingThePage:case qe.IsNotGuest:case qe.IsGuest:return null;case qe.UserIs:case qe.UserIsNot:return this.GetUserControl();case qe.HasNotRole:case qe.HasRole:return o.html` <rn-inputs-select style="min-height: 30px" multiple .value="${this.Condition.Options.Value}" @change="${e=>this.OnChange(e.detail)}" .propertyName="${"Type"}" .options="${rnBuilderVar.Roles.map((e=>({Label:e.Label,Value:e.Id})))}"></rn-inputs-select> `}}GetUserControl(){let e=g.Sanitizer.SanitizeStringArray(this.Condition.Options.Value);return Ct.GetInstance().HasAllUsers(e)?o.html` <rn-inputs-select .load="${this.LoadUsers}" style="min-height: 30px" multiple .value="${this.Condition.Options.Value}" @change="${e=>this.OnChange(e.detail)}" .options="${Ct.GetInstance().GetUserList()}" .propertyName="${"Type"}"></rn-inputs-select> `:(Ct.GetInstance().GetUsersById(e).then((e=>this.Condition.Refresh())),o.html`<span>Loading users</span>`)}async LoadUsers(e,t){let i=await v.WpAjaxPost.Post("list_users",{query:e},"",null,{Nonce:rnBuilderVar._nonce,Prefix:rnBuilderVar._prefix});if(null!=i)for(let e of i)Ct.GetInstance().AddUser(e.Value,e.Label);t(i)}ComparisonChanged(e){this.Condition.Options.Comparison=e,this.Condition.Options.Value=[],this.MaybeInitializeValue(),this.Condition.Refresh()}ValueChanged(e){this.Condition.Options.Value=e,this.Condition.Refresh()}GetAvailableOptions(){let e=[];if(this.Condition.Options.Type==ke.Standard){let t=this.ConditionField;if(null==t||!(t instanceof ct))return e;for(let i of t.Items)e.push({label:i.Label,value:i.Value})}return e}ValueIsValid(){return this.Condition.Options.Comparison==qe.UserViewingThePage||this.Condition.Options.Comparison==qe.IsGuest||this.Condition.Options.Comparison==qe.IsNotGuest||g.Sanitizer.SanitizeStringArray(this.Condition.Options.Value).length>0}OnChange(e){void 0!==e&&(this.Condition.Options.Value=e.map((e=>e)),this.Condition.Refresh())}SanitizeValue(){this.Condition.Options.Value=g.Sanitizer.SanitizeStringArray(this.Condition.Options.Value)}}gt.CachedUsers=new Map;class bt extends nt{constructor(){super()}GetComparator(){return o.html` <select ?className=${this.GetComparisonClass()} .value=${this.Condition.Options.Comparison} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: auto;padding: 0;width: 100%"> <option ?selected="${this.Condition.Options.Comparison==qe.IsStarred}" .value=${qe.IsStarred}>Is starred</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsNotStared}" .value=${qe.IsNotStared}>${RNTranslate("Is not starred")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsViewed}" .value=${qe.IsViewed}>${RNTranslate("Is viewed")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsNotViewed}" .value=${qe.IsNotViewed}>${RNTranslate("Is not viewed")}</option> </select> `}InitializeValues(){this.Condition.Options.Comparison=qe.IsStarred,this.Condition.Options.AdditionalOptions=null}GetValueInput(){return null}ComparisonChanged(e){this.Condition.Options.Comparison=qe[e],this.Condition.Options.Value="",this.Condition.Refresh()}ValueChanged(e){this.Condition.Options.Value=e,this.Condition.Refresh()}SanitizeValue(){super.SanitizeValue()}}bt.CachedUsers=new Map;class vt extends nt{GetComparator(){return o.html` <select .value=${this.Condition.Options.Comparison} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: 28px;padding: 0;width: 100%"> <option ?selected="${this.Condition.Options.Comparison==qe.Contains}" value=${qe.Contains}>${RNTranslate("Contains")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.NotContains}" value=${qe.NotContains}>${RNTranslate("Not Contains")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsEmpty}" value=${qe.IsEmpty}>${RNTranslate("Is Empty")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.IsNotEmpty}" value=${qe.IsNotEmpty}>${RNTranslate("Is Not Empty")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.Equal}" value=${qe.Equal}>${RNTranslate("Amount is equal")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.NotEqual}" value=${qe.NotEqual}>${RNTranslate("Amount is not equal")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.GreaterThan}" value=${qe.GreaterThan}>${RNTranslate("Amount is greater than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.GreaterOrEqualThan}" value=${qe.GreaterOrEqualThan}>${RNTranslate("Amount is greater or equal than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.LessThan}" value=${qe.Equal}>${RNTranslate("Amount is less than")}</option> <option ?selected="${this.Condition.Options.Comparison==qe.LessOrEqualThan}" value=${qe.Equal}>${RNTranslate("Amount is less or equal than")}</option> </select> `}InitializeValues(){this.Condition.Options.Comparison=qe.Contains,this.Condition.Options.AdditionalOptions=null,this.Condition.Options.Value=[]}IsMultipleOptions(){return[qe.IsEmpty,qe.IsNotEmpty,qe.Contains,qe.NotContains].indexOf(this.Condition.Options.Comparison)>=0}GetValueInput(){if(this.IsMultipleOptions()){if(Array.isArray(this.Condition.Options.Value)||(this.Condition.Options.Value=[]),this.Condition.Options.Comparison==qe.IsEmpty||this.Condition.Options.Comparison==qe.IsNotEmpty)return null;let e=this.GetAvailableOptions(),t=e.filter((e=>this.Condition.Options.Value.indexOf(e.Value)>=0)).map((e=>e.Value));return o.html` <rn-inputs-select style="min-height: 30px" multiple .value="${t}" @change="${e=>this.OnChange(e.detail)}" .propertyName="${"Value"}" .options="${e}" ></rn-inputs-select> `}return Array.isArray(this.Condition.Options.Value)&&(this.Condition.Options.Value=""),o.html` <input type="number" style="width: 100%;height: auto;padding: 0 7px" placeholder="Quantity" .value="${this.Condition.Options.Value}" @change="${e=>{this.Condition.Options.Value=e.target.value}}"/> `}GetAvailableOptions(){let e=[];if(this.Condition.Options.Type==ke.Standard){let t=this.ConditionField;if(null==t||!(t instanceof ct))return e;for(let i of t.Items)e.push({Label:i.Label,Value:i.Value})}return e}SanitizeValue(){this.IsMultipleOptions()?this.Condition.Options.Value=g.Sanitizer.SanitizeStringArray(this.Condition.Options.Value):this.Condition.Options.Value=g.Sanitizer.SanitizeNumber(this.Condition.Options.Value)}ComparisonChanged(e){this.Condition.Options.Comparison=qe[e],[qe.Equal,qe.NotEqual,qe.GreaterThan,qe.GreaterOrEqualThan,qe.LessThan,qe.LessOrEqualThan].indexOf(this.Condition.Options.Comparison)>=0?this.Condition.Options.Column="numericvalue":this.Condition.Options.Column="",this.Condition.Refresh()}OnChange(e){this.Condition.Options.Value=e,this.Condition.Refresh()}}var Ot,wt,St,It,Tt={},xt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="circle-question",i=[62108,"question-circle"],n="f059",o="M256 512c141.4 0 256-114.6 256-256S397.4 0 256 0S0 114.6 0 256S114.6 512 256 512zM169.8 165.3c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24V250.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1H222.6c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM288 352c0 17.7-14.3 32-32 32s-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32z";e.definition={prefix:"fas",iconName:t,icon:[512,512,i,n,o]},e.faCircleQuestion=e.definition,e.prefix="fas",e.iconName=t,e.width=512,e.height=512,e.ligatures=i,e.unicode=n,e.svgPathData=o,e.aliases=i}(xt),function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=xt;e.definition={prefix:t.prefix,iconName:t.iconName,icon:[t.width,t.height,t.aliases,t.unicode,t.svgPathData]},e.faQuestionCircle=e.definition,e.prefix=t.prefix,e.iconName=t.iconName,e.width=t.width,e.height=t.height,e.ligatures=t.aliases,e.unicode=t.unicode,e.svgPathData=t.svgPathData,e.aliases=t.aliases}(Tt);class $t extends class{Initialize(e){return this.Condition=e,this.Condition.Options.Comparison==qe.None&&(this.Condition.Options.Column="",this.InitializeValues()),this}get ConditionField(){return this.Condition.Parent.Parent.GetFieldById(this.Condition.Options.FieldId)}Render(){var e,t,i,n,s;let a=null===(e=this.Condition.Parent.Parent.GetFields())||void 0===e?void 0:e.filter((e=>e.UseInConditions));if(null==a)return o.html` <p>Please select a form first</p> `;let r=this.Condition.Options.FieldId+"_"+this.Condition.Options.PathId;""==this.Condition.Options.PathId&&(r="");let l=Je.GetSpecialConditionValueInput(this.Condition);null==l&&(l=this.GetValueInput()),"Advanced"==this.Condition.Options.Type&&(r=this.Condition.Options.FieldId);let d=null===(t=rnAutomationBuilder)||void 0===t||null===(i=t.Trigger)||void 0===i||null===(n=i.CurrentTrigger)||void 0===n||null===(s=n.Options)||void 0===s?void 0:s.Type,p=it.GetSpecialConditionsByTrigger(d);return o.html` <div> <div class='conditionLine' style="display: flex;align-items: flex-start;margin-bottom: 5px;padding: 5px"> <div style="width:30%;" class='conditionColumn'> <select .value=${C.live(r)} style="height: auto;padding: 0;width: 100%" class=${""==r&&this.ShouldShowErrors()?"rnInvalidCondition":""} @change=${e=>this.FieldChanged(e.target.value,e.target[e.target.selectedIndex].getAttribute("data-linetype").toString(),e.target[e.target.selectedIndex])}> <option ?selected="${""==r}" value="" data-linetype=${ke.None.toString()}>${RNTranslate("Select a field")}</option> <optgroup .label=${RNTranslate("Fields")}> ${a.map((e=>e.GetDataSections("Filter").map(((t,i)=>o.html` <option ?selected="${r==e.Id+"_"+t.PathId}" data-path-id=${t.PathId} data-field-id=${e.Id} data-linetype=${ke.Standard.toString()} .value=${e.Id+"_"+t.PathId}>${(i>0?"    ":"")+t.Label}</option> `))))} </optgroup> ${c.rnIf(p.length>0&&o.html` <optgroup label="Advanced"> ${b.repeat(p,(e=>e.Type),(e=>o.html` <option ?selected="${this.Condition.Options.FieldId==e.Type}" data-linetype=${ke.Advanced.toString()} data-field-id=${e.Type} .value=${e.Type}>${e.Label}</option> `))} </optgroup> `)} </select> </div> <div style="width: ${null!=l?"20%":"calc(70% - 80px)"}" class=${"conditionColumn"}> ${this.GetComparator(!1)} </div> ${this.GetValueSection(l)} <div style="width:80px" class='conditionColumn'> <button @click=${e=>{e.preventDefault(),this.Condition.Instance.FireEvent("addLine",this.Condition,!0)}} class='rnbtn rnbtn-light' style="padding: 1px 5px;">${RNTranslate("AND")}</button> <span class='ConditionRemove' style="line-height: 25px;vertical-align: middle;cursor: pointer;" @click=${e=>{e.preventDefault(),this.Condition.Instance.FireEvent("removeLine",this.Condition,!0)}}> <rn-fontawesome .icon=${ge.faTimes} style="margin-left: 5px"/></span> </div> </div> </div> `}AllowFieldMapping(){return!0}GetValueSection(e){if(null==e)return null;let t=null;if(this.Condition.Parent.Parent.AllowFieldMapping()&&this.AllowFieldMapping())if(this.Condition.Options.HasMapping){t=o.html` <div @click="${()=>{this.Condition.Options.Value=null,this.Condition.Options.HasMapping=!1,this.Condition.Refresh()}}" class="removeMapping rnIcon" title="Remove mapping" style="height: 30px;width: 30px;display: flex;align-items: center;justify-content: center;"> <rn-fontawesome .icon="${ve.faTrash}"></rn-fontawesome> </div>`;let i="Unknown";null!=this.Condition.Options.Value.Id&&null!=this.Condition.Options.Value.Path&&(i=this.Condition.Parent.Parent.GetAutomationBuilder().DataSource.GetFriendlyName(this.Condition.Options.Value.Id,this.Condition.Options.Value.Path,!0,!0)),e=o.html`<input .value="${i}" type="text" style="height: 30px;width: 100%;" readonly/>`}else t=o.html`<div @click="${()=>this.MapField()}" class="mapToField rnIcon" title="Map to field" style="height: 30px;width: 30px;display: flex;align-items: center;justify-content: center;"><rn-fontawesome .icon="${Ve.faLink}"></rn-fontawesome></div>`;return o.html` <div style="display: flex; width: calc(50% - 80px)" class=${"conditionColumn"}> <div style="flex-grow: 1"> ${e} </div> ${t} </div> `}ShouldShowErrors(){return!1}FieldChanged(e,t,i){if(t==ke.Advanced&&!Ye.IsValid())return void this.Condition.Refresh();let n;if(this.Condition.Options.PathId="",ke[t]==ke.Standard){let e=i.getAttribute("data-field-id"),t=this.Condition.Parent.Parent.GetFieldById(e);n=null==t?He.None:t.Type,this.Condition.Options.FieldId=e,this.Condition.Options.PathId=i.getAttribute("data-path-id"),t.Type==He.Multiple?this.Condition.Options.Value=g.Sanitizer.SanitizeStringArray(this.Condition.Options.Value):this.Condition.Options.Value=g.Sanitizer.SanitizeString(this.Condition.Options.Value)}ke[t]==ke.None&&(this.Condition.Options.FieldId=""),this.Condition.Options.Comparison=qe.None,this.Condition.Options.Type=ke[t],this.Condition.Options.SubType=n,t==ke.Advanced&&(this.Condition.Options.FieldId=e,this.Condition.Options.Value=""),this.Condition.Instance.FireEvent("fieldChanged"),this.Condition.Refresh()}MaybeInitializeValue(){Je.MaybeInitializeValue(this.Condition)}SanitizeValue(){this.Condition.Options.Value=g.Sanitizer.SanitizeString(this.Condition.Options.Value)}ValueIsValid(){return this.Condition.Options.Comparison==qe.IsEmpty||this.Condition.Options.Comparison==qe.IsNotEmpty||""!=g.Sanitizer.SanitizeString(this.Condition.Options.Value)}ComparisonIsValid(){return this.Condition.Options.Comparison!=qe.None}GetValueClass(){return!this.ValueIsValid()&&this.Condition.ShowValidations?"rnInvalidCondition":""}GetComparisonClass(){return!this.ComparisonIsValid()&&this.Condition.Options?"rnInvalidCondition":""}Validate(){return""==this.Condition.Options.FieldId?(i.ToastService.SendErrorMessage("Please select a field"),this.Condition.ShowValidations=!0,!1):this.ComparisonIsValid()?this.ValueIsValid()?(this.Condition.ShowValidations=!1,!0):(i.ToastService.SendErrorMessage("Invalid Value"),this.Condition.ShowValidations=!0,!1):(i.ToastService.SendErrorMessage("Invalid Comparison"),this.Condition.ShowValidations=!0,!1)}async MapField(){if(""==this.Condition.Options.FieldId)return void i.ToastService.SendErrorMessage("Please select a field first");let e=this.Condition.Parent.Parent.GetFieldById(this.Condition.Options.FieldId);if(null==e)return void i.ToastService.SendErrorMessage("Selected field not found, please pick another field");let t=await p.Dialog.Show(o.html`<rn-field-dialog .allowedFieldSubType="${e.SubType}" .allowedFieldPath="${this.Condition.Options.PathId}" .AutomationBuilder="${this.Condition.Parent.Parent.GetAutomationBuilder()}"></rn-field-dialog>`);null!=t&&(this.Condition.Options.HasMapping=!0,this.Condition.Options.Value=t.Value,this.Condition.Refresh())}}{constructor(...e){super(...e),this.AvailableOptions=[{Label:"The same field value has been submitted x times",Value:"SameFieldValue"},{Label:"The same field value has been submitted a maximum of x times",Value:"SameFieldValueMaximum"},{Label:"The same field value has been submitted a minimum of x times",Value:"SameFieldValueMinimum"}]}GetComparator(e){var t;return o.html` <select title="${null===(t=this.AvailableOptions.find((e=>e.Value==this.Condition.Options.Comparison)))||void 0===t?void 0:t.Label}" class=${this.GetComparisonClass()} .value=${this.Condition.Options.Comparison} @change=${e=>this.ComparisonChanged(e.target.value.toString())} style="height: auto;padding: 0;width: 100%"> <option .value=${""}>Select an option</option> ${this.AvailableOptions.map((e=>o.html` <option ?selected="${this.Condition.Options.Comparison==e.Value}" .value=${e.Value}>${e.Label}</option> `))} </select> `}GetValueInput(){var e;return this.Condition.Options.Comparison==qe.None?null:o.html`<div style="display: inline-flex;width: 100%"> <div style="display: inline-flex;flex-direction: column;width: 100%"> <rn-inputs-select multiple .value="${this.Condition.Options.Value.Fields}" @change="${e=>{this.Condition.Options.Value.Fields=e.detail}}" .propertyName="${"Type"}" .options="${null===(e=this.Condition.Parent.Parent.GetFields())||void 0===e?void 0:e.filter((e=>["Text","Multiple"].indexOf(e.Type)>=0)).map((e=>({Label:e.Label,Value:e.Id})))}" style="margin:0;min-height: 30px"> </rn-inputs-select> <div style="display: flex"> <label style="margin-right: 5px">Fields To Check</label> <rn-tooltip .tooltip="${"Only the entries that have the same value in all the fields you add here will be considered"}" .content="${o.html`<rn-fontawesome .icon="${Tt.faQuestionCircle}"></rn-fontawesome>`}"></rn-tooltip> </div> </div> <div style="display: inline-flex;flex-direction: column;width: 120px"> <input style="height: 30px" type="number" .value="${this.Condition.Options.Value.NumberOfTimes}" @change="${e=>this.Condition.Options.Value.NumberOfTimes=e.target.value}"> <label>Number of Times</label> </div> </div>`}InitializeValues(){this.Condition.Options.Comparison=qe.None}SanitizeValue(){var e,t;null==(null===(e=this.Condition.Options)||void 0===e||null===(t=e.Value)||void 0===t?void 0:t.Fields)&&(this.Condition.Options.Value={Fields:[],NumberOfTimes:1})}ComparisonChanged(e){this.Condition.Options.Comparison=e,this.Condition.Options.Value={Fields:[],NumberOfTimes:1},this.MaybeInitializeValue(),this.Condition.Refresh()}}n.customElement("rnwppages-condition-line")(class extends m.LitModel{static get properties(){return{ShowValidations:{type:Boolean},model:{type:Object}}}GetFields(){return this.model.Parent.Parent.GetFields()}Refresh(){this.forceUpdate()}render(){if(null==this.GetFields())return o.html` <p style="color: red">Please select a form first</p> `;let e=class{static GetComparator(e){switch(e.Options.Type){case ke.None:return(new ot).Initialize(e);case ke.Standard:let t=null;switch(e.Options.SubType){case He.List:case He.Text:t=new st;break;case He.None:t=new ot;break;case He.Composed:t=new at;break;case He.DateTime:t=new lt;break;case He.Date:t=new dt;break;case He.Time:t=new pt;break;case He.Multiple:t=new mt;break;case He.Number:case He.Currency:t=new ft;break;case He.Toggle:t=new yt;break;case He.User:t=new gt;break;case He.EntryId:t=new bt;break;case He.CurrencyMultiple:t=new vt}if(null==t)throw new Error("Comparator not found for "+e.Options.SubType);return t.Initialize(e),t;case ke.Advanced:switch(e.Options.FieldId){case"PreviousSubmissions":return(new $t).Initialize(e)}}}}.GetComparator(this.model);return this.model.LastComparator=e,null==e?null:(this.model.Options.HasMapping||(Je.HasSpecialCondition(this.model)?Je.MaybeSanitizeValue(this.model):e.SanitizeValue()),e.Render())}get ConditionLineOptions(){return this.model.Options}get ConditionGroup(){return this.model.Parent}});class Vt extends f.ModelWithParent{constructor(e,t){super(e,t)}render(){return o.html`<rnwppages-condition-line ${y.ref((e=>this.Instance=e))} .model="${this}"></rnwppages-condition-line>`}Validate(){var e;let t=null===(e=this.LastComparator)||void 0===e?void 0:e.Validate();return!1!==t&&t}}n.customElement("rnwppages-condition-group")(((Ot=class extends m.LitModel{render(){return o.html` <div class='rnConditionGroup' style="margin-bottom: 10px; table-layout: fixed;width: 100%;"> <div @addLine="${e=>this.AddLineBellow(e.detail)}" @removeLine="${e=>this.RemoveLine(e.detail)}"> ${this.model.Lines.map(((e,t)=>e.render()))} </div> </div> `}AddLineBellow(e){let t=this.model.Lines.indexOf(e);if(t<0)return;let i=(new Ne).Merge();this.model.Lines.splice(t+1,0,new Vt(i,this.model)),this.model.Options.ConditionLines.splice(t+1,0,i),this.FireEvent("fieldChanged",null,!0),this.forceUpdate()}RemoveLine(e){let t=this.model.Lines.indexOf(e);t<0||(this.model.Lines.splice(t,1),this.model.Options.ConditionLines.splice(t,1),0!=this.model.Lines.length?(this.FireEvent("fieldChanged",null,!0),this.forceUpdate()):this.FireEvent("removeGroup",this.model,!0))}get ConditionBuilder(){return this.model.Parent}}).defaultProps={},Ot));let Nt=(wt=t.ModelSerialize("ConditionLines"),St=class extends f.ModelWithParent{constructor(e,t){super(e,t),babelHelpers.initializerDefineProperty(this,"Lines",It,this),this.Lines=[];for(let e of this.Options.ConditionLines)this.Lines.push(new Vt(e,this))}render(e,t){return o.html`<rnwppages-condition-group @fieldChanged=${()=>e()} @removeGroup=${()=>t()} .model="${this}"></rnwppages-condition-group>`}Validate(){for(let e of this.Lines)if(!1===e.Validate())return!1;return!0}},It=babelHelpers.applyDecoratedDescriptor(St.prototype,"Lines",[wt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),St);class At extends t.ModelBase{constructor(e,t){super(e),this.AutomationBuilder=t,this.Label="Execute the trigger only when this condition is met",this._allowFieldMapping=!1,this.Groups=[];for(let e of this.Options.ConditionGroups)this.Groups.push(new Nt(e,this))}SetAllowFieldMapping(e=!0){this._allowFieldMapping=e}SetLabel(e){this.Label=e}GetFields(){var e;return null===(e=this.AutomationBuilder.DataSource)||void 0===e?void 0:e.GetFields()}GetFieldById(e){var t;return null===(t=this.AutomationBuilder.DataSource)||void 0===t?void 0:t.GetFieldById(e)}render(){return o.html`<rnwppages-condition-builder .model="${this}"></rnwppages-condition-builder>`}AllowFieldMapping(){return this._allowFieldMapping}CreateGroup(){if(!Ye.IsValid())return;let e=(new Pe).Merge({ConditionLines:[{}]});this.Options.ConditionGroups.push(e),this.Groups.push(new Nt(e,this)),this.Refresh()}Validate(){for(const e of this.Groups)if(!e.Validate())return!1;return!0}GetAutomationBuilder(){return this.AutomationBuilder}}var Et,Gt,Dt;n.customElement("rn-condition-dialog")(class extends u.DialogBase{InternalGetOptions(){return{Title:"Configure a condition",ApplyButtonTitle:"Apply",ShowApplyButton:!0,Styles:{width:"800px",maxWidth:"80%"}}}SubRender(){return null==this.ConditionBuilder&&(this.ConditionBuilder=new At(this.condition,this.formBuilder)),this.ConditionBuilder.render()}async OnApply(){return this.SendResult(this.condition),!0}});class Lt extends l.SchemaBase{constructor(e){super(),this.FormBuilder=e}GetNodes(){return{condition:{content:"block+",group:"block",defining:!0,attrs:{condition:{default:null}},parseDOM:[{tag:"div",getAttrs:e=>({options:e.getAttribute("data-condition")})}],toDOM:()=>["div",{style:"border:1px solid blue;"},["div",{style:"background-color:blue;color:white;text-align:center;width:100%;padding:2px;"},"Conditional Group"],["div",{style:"width:100%;padding:5px;"},0]]}}}GetMenuItems(){return[new d.MenuItem({title:"Condition",render:()=>o.renderInline(o.html`<div style="cursor:pointer;display: flex;align-items: center;" title="Insert Condition"><rn-fontawesome style="margin-right: 3px;font-size: 16px" .icon="${ue.faPlus}"></rn-fontawesome>Condition</div>`),enable:function(e){return!0},run:async(e,t,i)=>{let n=(new je).Merge({ConditionGroups:[{ConditionLines:[{}]}]});null!=await p.Dialog.Show(o.html`<rn-condition-dialog .formBuilder="${this.FormBuilder}" .condition="${n}"></rn-condition-dialog>`)&&(i.dispatch(i.state.tr.replaceSelectionWith(e.doc.type.schema.nodes.condition.createAndFill({condition:JSON.stringify(n.ToObject())}))),i.focus())}}),new O.ButtonMenuItem("Edit Condition",(async e=>{let t=w.TextEditorUtilities.GetNodeInSelection(e,"condition",!0);if(null==t)return;let i=JSON.parse(t.node.attrs.condition);i=(new je).Merge(i);let n=await p.Dialog.Show(o.html`<rn-condition-dialog .formBuilder="${this.FormBuilder}" .condition="${i}"></rn-condition-dialog>`);null!=n&&w.TextEditorUtilities.UpdateNodeAttributes(e,t.pos,"condition",JSON.stringify(n.ToObject()))})).SetIsSubMenu().SetIsInsideNode("condition")]}}n.customElement("rnwppages-email-property")(class extends pe{constructor(...e){super(...e),this.LatestObjectToUse=null}SubRender(){return o.html` <rn-text-editor style="height:200px" .value="${this.model.GetValue()}" .nodes="${[new s.ImageNode,new a.FieldNode(this.model.Element.AutomationBuilder),new Ce,new Lt(this.model.Element.AutomationBuilder)]}" @change="${e=>this.model.SetValue(e.detail)}"> </rn-text-editor> `}update(e){super.update(e),this.LatestModel!=this.model&&(this.MaybeUnsubscribe(),this.LatestModel=this.model.Element,this.MaybeSubscribe())}IsStoreBase(){if(null!=this.model.Element.Options&&null!=this.model.Element.Options.ValueChanged)return!0}MaybeUnsubscribe(){this.IsStoreBase()&&this.model.Element.Options.Unsubscribe(this)}MaybeSubscribe(){this.IsStoreBase()&&this.model.Element.Options.Subscribe(this,(e=>{e==this.model.PropertyName&&this.forceUpdate()}))}});class Pt{constructor(e,t,i=""){this.Element=e,this.PropertyName=t,this.Label=i,this.RefreshPropertiesPanel=!1,this.IsPR=!1,this.OnGetValue=null,this.OnChange=null,this.OptionsOverwrite=null,this.AdditionalClasses="",this._hint=null,this.OnRefresh=new S.SingleEvent,this.PropertyChanged=new S.SingleEvent}SetIsInline(e=!0){return e?this.AdditionalClasses+=" inline":this.AdditionalClasses=this.AdditionalClasses.replace(" inline",""),this}SetHint(e){return this._hint=e,this}MaybeAddHint(){return null==this._hint?null:o.html` <div>${this._hint}</div> `}Clear(){}SetOptionsOverwrite(e){return this.OptionsOverwrite=e,this}SetRefreshPropertiesPanel(){return this.RefreshPropertiesPanel=!0,this}SetIsPR(){return this.IsPR=!0,this}SetOnGetValue(e){return this.OnGetValue=e,this}SetOnChange(e){return this.OnChange=e,this}GetOptions(){var e;return null!=this.OptionsOverwrite?this.OptionsOverwrite:null===(e=this.Element)||void 0===e?void 0:e.Options}SetStringValue(e){this.SetValue(g.Sanitizer.SanitizeString(e))}GetValue(e=null){var t;if(null!=this.OnGetValue)return this.OnGetValue();let i=null===(t=this.Element)||void 0===t?void 0:t.Options;return null!=this.OptionsOverwrite&&(i=this.OptionsOverwrite),null===e&&(e=this.PropertyName),null==i.GetValue(e)?null:i.GetValue(e)}GetBooleanValue(e=null){return g.Sanitizer.SanitizeBoolean(this.GetValue(e),!1)}SetBooleanValue(e,t=null){this.SetValue(g.Sanitizer.SanitizeBoolean(e),t)}GetStringValue(e=null){let t=this.GetValue(e);return Array.isArray(t)&&(t=t.length>0?t[0]:""),null==t?"":t.toString()}GetNumberValue(){let e=Number(this.GetValue());return isNaN(e)?0:e}Refresh(){this.OnRefresh.Publish()}SetValue(e,t=null){var i;if(this.IsPR&&""==rnBuilderVar.IsPR)p.Dialog.Show(o.html`<rnwppages-license-required .message="${"Sorry this feature is only available in the full version"}"></rnwppages-license-required>`);else{if(null!=this.OnChange){if(!1===this.OnChange(e))return;this.PropertyChanged.Publish()}else{var n;Array.isArray(this.GetValue())&&!Array.isArray(e)&&""!=e.toString()&&(e=[e]);let i=null===(n=this.Element)||void 0===n?void 0:n.Options;null!=this.OptionsOverwrite&&(i=this.OptionsOverwrite),null===t&&(t=this.PropertyName),i.SetValue(t,e),this.PropertyChanged.Publish()}this.RefreshPropertiesPanel?I.EventManager.Publish("RefreshFieldProperties"):this.Refresh(),null===(i=this.Element)||void 0===i||i.Refresh()}}}class Rt extends Pt{constructor(e,t,i){super(e,t,i),this.CustomValues=[],this.ActivateChangeWhenBlur=!1}SetActivateChangeWhenBlur(){return this.ActivateChangeWhenBlur=!0,this}Render(){return o.html` <rnwppages-email-property .model="${this}"></rnwppages-email-property> `}AddCustomValue(e,t){return this.CustomValues.push({Value:t,Label:e}),this}}n.customElement("rn-text-with-tags-property")(class extends pe{constructor(...e){super(...e),this.Placeholder=""}static get properties(){return{}}SubRender(){return o.html` <div style="position: relative;"> <rn-single-line-text-editor .collection="${this.model.Collections}" .value="${this.model.GetValue()}" @change="${e=>{this.model.SetValue(e.detail)}}"></rn-single-line-text-editor> </div> `}SetPlaceholder(e){return this.Placeholder=e,this}});class Ft extends Pt{constructor(e,t,i){super(e,t,i),this.Hint="",this.Collections=new T.SingleLineCollection}SetHint(e){return this.Hint=e,this}SetAddEntryInfoGroup(){return this.Collections.Groups.some((e=>"EntryInfo"==e.Type))||this.Collections.CreateGroup("fixed","Entry Info",(e=>{e.CreateItem("EntryNumber","Entry Number"),e.CreateItem("EntryDate","Entry Date"),e.CreateItem("SubmittedBy","Submitted By")})),this}SetCreateGroup(e,t,i=null){return this.Collections.CreateGroup(e,t,i),this}SetAddFieldsGroup(){if(!this.Collections.Groups.some((e=>"Field"==e.Type)))return this.Collections.CreateGroup("Field","Fields",(e=>{var t;return null===(t=this.Element.AutomationBuilder.DataSource.GetFields())||void 0===t?void 0:t.forEach((t=>{t.GetDataSections("Display").forEach(((t,i)=>{e.CreateItem(t.Id+"_"+t.PathId,this.Element.AutomationBuilder.DataSource.GetFriendlyName(t.Id,t.PathId,!0,!1),0==i?0:1)}))}))})),this}Render(){return o.html`<rn-text-with-tags-property .model=${this}></rn-text-with-tags-property>`}}n.customElement("rnwppages-simple-text-property")(class extends pe{static get properties(){return{}}SubRender(){return o.html` <div style="position: relative;"> <input placeholder="${this.model._placeholder}" type="text" style="position:relative;width: 100%" .value=${C.live(this.model.GetStringValue())} @input="${e=>this.model.SetValue(e.target.value)}"/> ${this.model.MaybeAddHint()} </div> `}});class Mt extends Pt{constructor(e,t,i){super(e,t,i),this.ActivateChangeWhenBlur=!1}SetActivateChangeWhenBlur(){return this.ActivateChangeWhenBlur=!0,this}SetPlaceholder(e){return this._placeholder=e,this}Render(){return o.html`<rnwppages-simple-text-property .model="${this}"></rnwppages-simple-text-property>`}}n.customElement("rn-email-address-property")(class extends pe{SubRender(){return o.html` <rn-inputs-select .valueField="${"Value"}" .store="${this.model.GetOptions()}" .propertyName="${this.model.PropertyName}" .createOnSpace="${!0}" multiple .placeholder=${"Email address"} .label=${""} .options="${()=>this.GetOptions()}" .onCreate="${e=>{if(/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e.toLowerCase()))return{Value:"Fixed_"+e,Item:{Type:X.Fixed,Value:e},Label:e};i.ToastService.SendErrorMessage("Invalid email address")}}" ></rn-inputs-select>`}GetOptions(){return[...window.rnAutomationBuilder.DataSource.GetFields().filter((e=>["text","radio","checkbox","select","email"].indexOf(e.SubType)>=0)).map((e=>({Label:this.GetFieldLabel(e),Value:e.Id,Item:{Type:"Field",Value:e.Id}}))),...this.model.GetOptions().GetValue(this.model.PropertyName).map((e=>({Value:e.Value,Label:e.Value,Item:{Type:"Fixed",Value:e.Value}}))),...this.model.CustomValues.map((e=>({Value:"Custom_"+e.Value,Label:e.Label,Item:{Type:"Custom",Value:e.Value}})))]}GetFieldLabel(e){return""!=e.Label?e.Label+" (Id: "+e.Id+")":"Id: "+e.Id}});class zt extends Pt{constructor(...e){super(...e),this.CustomValues=[]}Render(){return o.html`<rn-email-address-property .model="${this}"></rn-email-address-property>`}AddCustomValue(e,t){return this.CustomValues.push({Value:t,Label:e}),this}}class Bt extends de{GetSettings(){return[this.CreateSetting("To",new zt(this,"To","")),this.CreateSetting("Subject",new Ft(this,"Subject","").SetAddFieldsGroup()),this.CreateSetting("From Name",new Mt(this,"FromName","")),this.CreateSetting("From email address",new Mt(this,"FromEmailAddress","")),this.CreateSetting("Reply to",new zt(this,"ReplyTo","")),this.CreateSetting("CC",new zt(this,"CC","")),this.CreateSetting("BCC",new zt(this,"BCC","")),this.CreateSetting("Email",new Rt(this,"Email",""))]}GetTitle(){return"Send email"}}n.customElement("rn-edit-entry-item-control")(class extends r.LitElementBase{GetDisplay(){return"table-row"}render(){return o.html` ${this.GetFieldPicker()} <div style="display: table-cell;padding: 10px">${this.GetInput()}</div> <div @click="${()=>this.Remove()}" style="display: table-cell;padding: 10px;font-size: 20px;text-align: center;"><rn-fontawesome .icon="${ge.faTimes}" class="removeButton"></rn-fontawesome></div> `}GetFieldPicker(){var e,t;return o.html` <div style="display: table-cell;padding: 10px"> <rn-inputs-select style="margin:0" .value="${this.Options.FieldId}" @change="${e=>this.FieldChanged(e.detail)}" .propertyName="${"LogType"}" .options="${null!==(e=null===(t=this.AutomationBuilder.DataSource)||void 0===t?void 0:t.GetFields().filter((e=>[He.Multiple,He.Text,He.DateTime].indexOf(e.Type)>=0)).map((e=>({Value:e.Id,Label:e.Id+": "+e.Label}))))&&void 0!==e?e:[]}"></rn-inputs-select> </div> `}FieldChanged(e){var t;this.Options.FieldId=e,this.Options.Value=null;let i=null===(t=this.AutomationBuilder.DataSource)||void 0===t?void 0:t.GetFieldById(this.Options.FieldId);this.Options.ValueType=i.Type,this.forceUpdate()}Remove(){this.FireEvent("Remove")}GetInput(){var e,t;let i=null===(e=this.AutomationBuilder.DataSource)||void 0===e?void 0:e.GetFieldById(this.Options.FieldId);if(null==i)return o.html`Select a field first`;switch(i.Type){case He.Text:return new Ft({Options:this.Options,AutomationBuilder:this.AutomationBuilder,Refresh:()=>{this.forceUpdate()}},"","").SetOnGetValue((()=>this.Options.Value)).SetOnChange((e=>{this.Options.Value=e,this.forceUpdate()})).SetAddFieldsGroup().Render();case He.DateTime:return o.html` <rn-inputs-text .value="${g.Sanitizer.SanitizeString(this.Options.Value)}" @change="${e=>{this.Options.Value=e.detail,this.forceUpdate()}}"></rn-inputs-text> `;case He.Multiple:let e=[];return i.Items.forEach((t=>{e.push({Value:t.Value,Label:t.Label})})),o.html` <rn-inputs-select style="margin:0" ?multiple="${"checkbox"==i.SubType}" .value="${null!==(t=this.Options.Value)&&void 0!==t?t:[]}" @change="${e=>{console.log(e.detail),this.Options.Value=Array.isArray(e.detail)?e.detail:[e.detail],this.forceUpdate()}}" .propertyName="${"LogType"}" .options="${e}"></rn-inputs-select> `}}}),n.customElement("rn-edit-entry")(class extends pe{static get properties(){return{}}SubRender(){let e=this.model.GetValue();return 0==e.length&&e.push((new ae).Merge()),o.html` <div style="position: relative;"> <div style="width: 100%;display: table;table-layout: fixed"> <div style="display: table-column-group"> <div style="display: table-column;width: 100%" ></div> <div style="display: table-column;width: 100%"></div> <div style="display: table-column;width: 50px"></div> </div> <div style="display: table-row"> <div style="display: table-cell;border: none;padding: 10px;font-weight: bold">Field</div> <div style="display: table-cell;border: none;padding: 10px;font-weight: bold;">Value</div> </div> ${b.repeat(e,(e=>e.Id),(e=>o.html`<rn-edit-entry-item-control @Remove="${()=>this.Remove(e)}" .Options="${e}" .AutomationBuilder="${this.model.Element.AutomationBuilder}"></rn-edit-entry-item-control>`))} </div> <div style="padding: 10px"> <button @click="${()=>this.AddField()}" class="rnbtn rnbtn-primary"><rn-fontawesome .icon="${ue.faPlus}"></rn-fontawesome> Add fields</button> </div> </div> `}AddField(){this.model.GetValue().push((new ae).Merge()),this.forceUpdate()}Remove(e){let t=this.model.GetValue();if(1==t.length)return void i.ToastService.SendErrorMessage("You should have at least one field");let n=t.indexOf(e);n>=0&&(t.splice(n,1),this.forceUpdate())}});class Ut extends Pt{constructor(e,t,i){super(e,t,i),this.ActivateChangeWhenBlur=!1}SetActivateChangeWhenBlur(){return this.ActivateChangeWhenBlur=!0,this}SetPlaceholder(e){return this._placeholder=e,this}Render(){return o.html`<rn-edit-entry .model="${this}"></rn-edit-entry>`}}class Ht extends de{GetSettings(){return[this.CreateSetting("Edit Entry",new Ut(this,"FieldsToEdit",""))]}GetTitle(){return"Update Entry"}}class _t extends de{GetSettings(){return[this.CreateSetting("Status",new Mt(this,"Status","Status").SetPlaceholder("Completed"))]}GetTitle(){return"Change Status"}}class kt extends E{LoadDefaultValues(){super.LoadDefaultValues(),this.Type="star_unstar",this.ChangeTo="star"}}let qt=(Et=e.StoreDataType(Object),Gt=class extends E{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Note",Dt,this)}LoadDefaultValues(){super.LoadDefaultValues(),this.Type="add_note",this.Note=null,this.NoteType="note"}},Dt=babelHelpers.applyDecoratedDescriptor(Gt.prototype,"Note",[Et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gt);var jt="top",Wt="bottom",Xt="right",Qt="left",Jt="auto",Yt=[jt,Wt,Xt,Qt],Kt="start",Zt="end",ei="viewport",ti="popper",ii=Yt.reduce((function(e,t){return e.concat([t+"-"+Kt,t+"-"+Zt])}),[]),ni=[].concat(Yt,[Jt]).reduce((function(e,t){return e.concat([t,t+"-"+Kt,t+"-"+Zt])}),[]),oi=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function si(e){return e?(e.nodeName||"").toLowerCase():null}function ai(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function ri(e){return e instanceof ai(e).Element||e instanceof Element}function li(e){return e instanceof ai(e).HTMLElement||e instanceof HTMLElement}function di(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ai(e).ShadowRoot||e instanceof ShadowRoot)}var pi={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var i=t.styles[e]||{},n=t.attributes[e]||{},o=t.elements[e];li(o)&&si(o)&&(Object.assign(o.style,i),Object.keys(n).forEach((function(e){var t=n[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],o=t.attributes[e]||{},s=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:i[e]).reduce((function(e,t){return e[t]="",e}),{});li(n)&&si(n)&&(Object.assign(n.style,s),Object.keys(o).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]};function ui(e){return e.split("-")[0]}var hi=Math.max,ci=Math.min,mi=Math.round;function fi(){var e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function yi(){return!/^((?!chrome|android).)*safari/i.test(fi())}function Ci(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var n=e.getBoundingClientRect(),o=1,s=1;t&&li(e)&&(o=e.offsetWidth>0&&mi(n.width)/e.offsetWidth||1,s=e.offsetHeight>0&&mi(n.height)/e.offsetHeight||1);var a=(ri(e)?ai(e):window).visualViewport,r=!yi()&&i,l=(n.left+(r&&a?a.offsetLeft:0))/o,d=(n.top+(r&&a?a.offsetTop:0))/s,p=n.width/o,u=n.height/s;return{width:p,height:u,top:d,right:l+p,bottom:d+u,left:l,x:l,y:d}}function gi(e){var t=Ci(e),i=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:n}}function bi(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&di(i)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function vi(e){return ai(e).getComputedStyle(e)}function Oi(e){return["table","td","th"].indexOf(si(e))>=0}function wi(e){return((ri(e)?e.ownerDocument:e.document)||window.document).documentElement}function Si(e){return"html"===si(e)?e:e.assignedSlot||e.parentNode||(di(e)?e.host:null)||wi(e)}function Ii(e){return li(e)&&"fixed"!==vi(e).position?e.offsetParent:null}function Ti(e){for(var t=ai(e),i=Ii(e);i&&Oi(i)&&"static"===vi(i).position;)i=Ii(i);return i&&("html"===si(i)||"body"===si(i)&&"static"===vi(i).position)?t:i||function(e){var t=/firefox/i.test(fi());if(/Trident/i.test(fi())&&li(e)&&"fixed"===vi(e).position)return null;var i=Si(e);for(di(i)&&(i=i.host);li(i)&&["html","body"].indexOf(si(i))<0;){var n=vi(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(e)||t}function xi(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function $i(e,t,i){return hi(e,ci(t,i))}function Vi(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Ni(e,t){return t.reduce((function(t,i){return t[i]=e,t}),{})}var Ai={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,n=e.name,o=e.options,s=i.elements.arrow,a=i.modifiersData.popperOffsets,r=ui(i.placement),l=xi(r),d=[Qt,Xt].indexOf(r)>=0?"height":"width";if(s&&a){var p=function(e,t){return Vi("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Ni(e,Yt))}(o.padding,i),u=gi(s),h="y"===l?jt:Qt,c="y"===l?Wt:Xt,m=i.rects.reference[d]+i.rects.reference[l]-a[l]-i.rects.popper[d],f=a[l]-i.rects.reference[l],y=Ti(s),C=y?"y"===l?y.clientHeight||0:y.clientWidth||0:0,g=m/2-f/2,b=p[h],v=C-u[d]-p[c],O=C/2-u[d]/2+g,w=$i(b,O,v),S=l;i.modifiersData[n]=((t={})[S]=w,t.centerOffset=w-O,t)}},effect:function(e){var t=e.state,i=e.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&bi(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ei(e){return e.split("-")[1]}var Gi={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Di(e){var t,i=e.popper,n=e.popperRect,o=e.placement,s=e.variation,a=e.offsets,r=e.position,l=e.gpuAcceleration,d=e.adaptive,p=e.roundOffsets,u=e.isFixed,h=a.x,c=void 0===h?0:h,m=a.y,f=void 0===m?0:m,y="function"==typeof p?p({x:c,y:f}):{x:c,y:f};c=y.x,f=y.y;var C=a.hasOwnProperty("x"),g=a.hasOwnProperty("y"),b=Qt,v=jt,O=window;if(d){var w=Ti(i),S="clientHeight",I="clientWidth";if(w===ai(i)&&"static"!==vi(w=wi(i)).position&&"absolute"===r&&(S="scrollHeight",I="scrollWidth"),w=w,o===jt||(o===Qt||o===Xt)&&s===Zt)v=Wt,f-=(u&&w===O&&O.visualViewport?O.visualViewport.height:w[S])-n.height,f*=l?1:-1;if(o===Qt||(o===jt||o===Wt)&&s===Zt)b=Xt,c-=(u&&w===O&&O.visualViewport?O.visualViewport.width:w[I])-n.width,c*=l?1:-1}var T,x=Object.assign({position:r},d&&Gi),$=!0===p?function(e){var t=e.x,i=e.y,n=window.devicePixelRatio||1;return{x:mi(t*n)/n||0,y:mi(i*n)/n||0}}({x:c,y:f}):{x:c,y:f};return c=$.x,f=$.y,l?Object.assign({},x,((T={})[v]=g?"0":"",T[b]=C?"0":"",T.transform=(O.devicePixelRatio||1)<=1?"translate("+c+"px, "+f+"px)":"translate3d("+c+"px, "+f+"px, 0)",T)):Object.assign({},x,((t={})[v]=g?f+"px":"",t[b]=C?c+"px":"",t.transform="",t))}var Li={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,n=i.gpuAcceleration,o=void 0===n||n,s=i.adaptive,a=void 0===s||s,r=i.roundOffsets,l=void 0===r||r,d={placement:ui(t.placement),variation:Ei(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Di(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Di(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},Pi={passive:!0};var Ri={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,i=e.instance,n=e.options,o=n.scroll,s=void 0===o||o,a=n.resize,r=void 0===a||a,l=ai(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&d.forEach((function(e){e.addEventListener("scroll",i.update,Pi)})),r&&l.addEventListener("resize",i.update,Pi),function(){s&&d.forEach((function(e){e.removeEventListener("scroll",i.update,Pi)})),r&&l.removeEventListener("resize",i.update,Pi)}},data:{}},Fi={left:"right",right:"left",bottom:"top",top:"bottom"};function Mi(e){return e.replace(/left|right|bottom|top/g,(function(e){return Fi[e]}))}var zi={start:"end",end:"start"};function Bi(e){return e.replace(/start|end/g,(function(e){return zi[e]}))}function Ui(e){var t=ai(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Hi(e){return Ci(wi(e)).left+Ui(e).scrollLeft}function _i(e){var t=vi(e),i=t.overflow,n=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+o+n)}function ki(e){return["html","body","#document"].indexOf(si(e))>=0?e.ownerDocument.body:li(e)&&_i(e)?e:ki(Si(e))}function qi(e,t){var i;void 0===t&&(t=[]);var n=ki(e),o=n===(null==(i=e.ownerDocument)?void 0:i.body),s=ai(n),a=o?[s].concat(s.visualViewport||[],_i(n)?n:[]):n,r=t.concat(a);return o?r:r.concat(qi(Si(a)))}function ji(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Wi(e,t,i){return t===ei?ji(function(e,t){var i=ai(e),n=wi(e),o=i.visualViewport,s=n.clientWidth,a=n.clientHeight,r=0,l=0;if(o){s=o.width,a=o.height;var d=yi();(d||!d&&"fixed"===t)&&(r=o.offsetLeft,l=o.offsetTop)}return{width:s,height:a,x:r+Hi(e),y:l}}(e,i)):ri(t)?function(e,t){var i=Ci(e,!1,"fixed"===t);return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}(t,i):ji(function(e){var t,i=wi(e),n=Ui(e),o=null==(t=e.ownerDocument)?void 0:t.body,s=hi(i.scrollWidth,i.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=hi(i.scrollHeight,i.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),r=-n.scrollLeft+Hi(e),l=-n.scrollTop;return"rtl"===vi(o||i).direction&&(r+=hi(i.clientWidth,o?o.clientWidth:0)-s),{width:s,height:a,x:r,y:l}}(wi(e)))}function Xi(e,t,i,n){var o="clippingParents"===t?function(e){var t=qi(Si(e)),i=["absolute","fixed"].indexOf(vi(e).position)>=0&&li(e)?Ti(e):e;return ri(i)?t.filter((function(e){return ri(e)&&bi(e,i)&&"body"!==si(e)})):[]}(e):[].concat(t),s=[].concat(o,[i]),a=s[0],r=s.reduce((function(t,i){var o=Wi(e,i,n);return t.top=hi(o.top,t.top),t.right=ci(o.right,t.right),t.bottom=ci(o.bottom,t.bottom),t.left=hi(o.left,t.left),t}),Wi(e,a,n));return r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}function Qi(e){var t,i=e.reference,n=e.element,o=e.placement,s=o?ui(o):null,a=o?Ei(o):null,r=i.x+i.width/2-n.width/2,l=i.y+i.height/2-n.height/2;switch(s){case jt:t={x:r,y:i.y-n.height};break;case Wt:t={x:r,y:i.y+i.height};break;case Xt:t={x:i.x+i.width,y:l};break;case Qt:t={x:i.x-n.width,y:l};break;default:t={x:i.x,y:i.y}}var d=s?xi(s):null;if(null!=d){var p="y"===d?"height":"width";switch(a){case Kt:t[d]=t[d]-(i[p]/2-n[p]/2);break;case Zt:t[d]=t[d]+(i[p]/2-n[p]/2)}}return t}function Ji(e,t){void 0===t&&(t={});var i=t,n=i.placement,o=void 0===n?e.placement:n,s=i.strategy,a=void 0===s?e.strategy:s,r=i.boundary,l=void 0===r?"clippingParents":r,d=i.rootBoundary,p=void 0===d?ei:d,u=i.elementContext,h=void 0===u?ti:u,c=i.altBoundary,m=void 0!==c&&c,f=i.padding,y=void 0===f?0:f,C=Vi("number"!=typeof y?y:Ni(y,Yt)),g=h===ti?"reference":ti,b=e.rects.popper,v=e.elements[m?g:h],O=Xi(ri(v)?v:v.contextElement||wi(e.elements.popper),l,p,a),w=Ci(e.elements.reference),S=Qi({reference:w,element:b,strategy:"absolute",placement:o}),I=ji(Object.assign({},b,S)),T=h===ti?I:w,x={top:O.top-T.top+C.top,bottom:T.bottom-O.bottom+C.bottom,left:O.left-T.left+C.left,right:T.right-O.right+C.right},$=e.modifiersData.offset;if(h===ti&&$){var V=$[o];Object.keys(x).forEach((function(e){var t=[Xt,Wt].indexOf(e)>=0?1:-1,i=[jt,Wt].indexOf(e)>=0?"y":"x";x[e]+=V[i]*t}))}return x}function Yi(e,t){void 0===t&&(t={});var i=t,n=i.placement,o=i.boundary,s=i.rootBoundary,a=i.padding,r=i.flipVariations,l=i.allowedAutoPlacements,d=void 0===l?ni:l,p=Ei(n),u=p?r?ii:ii.filter((function(e){return Ei(e)===p})):Yt,h=u.filter((function(e){return d.indexOf(e)>=0}));0===h.length&&(h=u);var c=h.reduce((function(t,i){return t[i]=Ji(e,{placement:i,boundary:o,rootBoundary:s,padding:a})[ui(i)],t}),{});return Object.keys(c).sort((function(e,t){return c[e]-c[t]}))}var Ki={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var o=i.mainAxis,s=void 0===o||o,a=i.altAxis,r=void 0===a||a,l=i.fallbackPlacements,d=i.padding,p=i.boundary,u=i.rootBoundary,h=i.altBoundary,c=i.flipVariations,m=void 0===c||c,f=i.allowedAutoPlacements,y=t.options.placement,C=ui(y),g=l||(C===y||!m?[Mi(y)]:function(e){if(ui(e)===Jt)return[];var t=Mi(e);return[Bi(e),t,Bi(t)]}(y)),b=[y].concat(g).reduce((function(e,i){return e.concat(ui(i)===Jt?Yi(t,{placement:i,boundary:p,rootBoundary:u,padding:d,flipVariations:m,allowedAutoPlacements:f}):i)}),[]),v=t.rects.reference,O=t.rects.popper,w=new Map,S=!0,I=b[0],T=0;T<b.length;T++){var x=b[T],$=ui(x),V=Ei(x)===Kt,N=[jt,Wt].indexOf($)>=0,A=N?"width":"height",E=Ji(t,{placement:x,boundary:p,rootBoundary:u,altBoundary:h,padding:d}),G=N?V?Xt:Qt:V?Wt:jt;v[A]>O[A]&&(G=Mi(G));var D=Mi(G),L=[];if(s&&L.push(E[$]<=0),r&&L.push(E[G]<=0,E[D]<=0),L.every((function(e){return e}))){I=x,S=!1;break}w.set(x,L)}if(S)for(var P=function(e){var t=b.find((function(t){var i=w.get(t);if(i)return i.slice(0,e).every((function(e){return e}))}));if(t)return I=t,"break"},R=m?3:1;R>0;R--){if("break"===P(R))break}t.placement!==I&&(t.modifiersData[n]._skip=!0,t.placement=I,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Zi(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function en(e){return[jt,Xt,Wt,Qt].some((function(t){return e[t]>=0}))}var tn={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,n=t.rects.reference,o=t.rects.popper,s=t.modifiersData.preventOverflow,a=Ji(t,{elementContext:"reference"}),r=Ji(t,{altBoundary:!0}),l=Zi(a,n),d=Zi(r,o,s),p=en(l),u=en(d);t.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:d,isReferenceHidden:p,hasPopperEscaped:u},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":u})}};var nn={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,i=e.options,n=e.name,o=i.offset,s=void 0===o?[0,0]:o,a=ni.reduce((function(e,i){return e[i]=function(e,t,i){var n=ui(e),o=[Qt,jt].indexOf(n)>=0?-1:1,s="function"==typeof i?i(Object.assign({},t,{placement:e})):i,a=s[0],r=s[1];return a=a||0,r=(r||0)*o,[Qt,Xt].indexOf(n)>=0?{x:r,y:a}:{x:a,y:r}}(i,t.rects,s),e}),{}),r=a[t.placement],l=r.x,d=r.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=d),t.modifiersData[n]=a}};var on={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=Qi({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}};var sn={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,n=e.name,o=i.mainAxis,s=void 0===o||o,a=i.altAxis,r=void 0!==a&&a,l=i.boundary,d=i.rootBoundary,p=i.altBoundary,u=i.padding,h=i.tether,c=void 0===h||h,m=i.tetherOffset,f=void 0===m?0:m,y=Ji(t,{boundary:l,rootBoundary:d,padding:u,altBoundary:p}),C=ui(t.placement),g=Ei(t.placement),b=!g,v=xi(C),O="x"===v?"y":"x",w=t.modifiersData.popperOffsets,S=t.rects.reference,I=t.rects.popper,T="function"==typeof f?f(Object.assign({},t.rects,{placement:t.placement})):f,x="number"==typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),$=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,V={x:0,y:0};if(w){if(s){var N,A="y"===v?jt:Qt,E="y"===v?Wt:Xt,G="y"===v?"height":"width",D=w[v],L=D+y[A],P=D-y[E],R=c?-I[G]/2:0,F=g===Kt?S[G]:I[G],M=g===Kt?-I[G]:-S[G],z=t.elements.arrow,B=c&&z?gi(z):{width:0,height:0},U=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},H=U[A],_=U[E],k=$i(0,S[G],B[G]),q=b?S[G]/2-R-k-H-x.mainAxis:F-k-H-x.mainAxis,j=b?-S[G]/2+R+k+_+x.mainAxis:M+k+_+x.mainAxis,W=t.elements.arrow&&Ti(t.elements.arrow),X=W?"y"===v?W.clientTop||0:W.clientLeft||0:0,Q=null!=(N=null==$?void 0:$[v])?N:0,J=D+j-Q,Y=$i(c?ci(L,D+q-Q-X):L,D,c?hi(P,J):P);w[v]=Y,V[v]=Y-D}if(r){var K,Z="x"===v?jt:Qt,ee="x"===v?Wt:Xt,te=w[O],ie="y"===O?"height":"width",ne=te+y[Z],oe=te-y[ee],se=-1!==[jt,Qt].indexOf(C),ae=null!=(K=null==$?void 0:$[O])?K:0,re=se?ne:te-S[ie]-I[ie]-ae+x.altAxis,le=se?te+S[ie]+I[ie]-ae-x.altAxis:oe,de=c&&se?function(e,t,i){var n=$i(e,t,i);return n>i?i:n}(re,te,le):$i(c?re:ne,te,c?le:oe);w[O]=de,V[O]=de-te}t.modifiersData[n]=V}},requiresIfExists:["offset"]};function an(e,t,i){void 0===i&&(i=!1);var n,o,s=li(t),a=li(t)&&function(e){var t=e.getBoundingClientRect(),i=mi(t.width)/e.offsetWidth||1,n=mi(t.height)/e.offsetHeight||1;return 1!==i||1!==n}(t),r=wi(t),l=Ci(e,a,i),d={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(s||!s&&!i)&&(("body"!==si(t)||_i(r))&&(d=(n=t)!==ai(n)&&li(n)?{scrollLeft:(o=n).scrollLeft,scrollTop:o.scrollTop}:Ui(n)),li(t)?((p=Ci(t,!0)).x+=t.clientLeft,p.y+=t.clientTop):r&&(p.x=Hi(r))),{x:l.left+d.scrollLeft-p.x,y:l.top+d.scrollTop-p.y,width:l.width,height:l.height}}function rn(e){var t=new Map,i=new Set,n=[];function o(e){i.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!i.has(e)){var n=t.get(e);n&&o(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){i.has(e.name)||o(e)})),n}var ln={placement:"bottom",modifiers:[],strategy:"absolute"};function dn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function pn(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,n=void 0===i?[]:i,o=t.defaultOptions,s=void 0===o?ln:o;return function(e,t,i){void 0===i&&(i=s);var o,a,r={placement:"bottom",orderedModifiers:[],options:Object.assign({},ln,s),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],d=!1,p={state:r,setOptions:function(i){var o="function"==typeof i?i(r.options):i;u(),r.options=Object.assign({},s,r.options,o),r.scrollParents={reference:ri(e)?qi(e):e.contextElement?qi(e.contextElement):[],popper:qi(t)};var a,d,h=function(e){var t=rn(e);return oi.reduce((function(e,i){return e.concat(t.filter((function(e){return e.phase===i})))}),[])}((a=[].concat(n,r.options.modifiers),d=a.reduce((function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e}),{}),Object.keys(d).map((function(e){return d[e]}))));return r.orderedModifiers=h.filter((function(e){return e.enabled})),r.orderedModifiers.forEach((function(e){var t=e.name,i=e.options,n=void 0===i?{}:i,o=e.effect;if("function"==typeof o){var s=o({state:r,name:t,instance:p,options:n}),a=function(){};l.push(s||a)}})),p.update()},forceUpdate:function(){if(!d){var e=r.elements,t=e.reference,i=e.popper;if(dn(t,i)){r.rects={reference:an(t,Ti(i),"fixed"===r.options.strategy),popper:gi(i)},r.reset=!1,r.placement=r.options.placement,r.orderedModifiers.forEach((function(e){return r.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<r.orderedModifiers.length;n++)if(!0!==r.reset){var o=r.orderedModifiers[n],s=o.fn,a=o.options,l=void 0===a?{}:a,u=o.name;"function"==typeof s&&(r=s({state:r,options:l,name:u,instance:p})||r)}else r.reset=!1,n=-1}}},update:(o=function(){return new Promise((function(e){p.forceUpdate(),e(r)}))},function(){return a||(a=new Promise((function(e){Promise.resolve().then((function(){a=void 0,e(o())}))}))),a}),destroy:function(){u(),d=!0}};if(!dn(e,t))return p;function u(){l.forEach((function(e){return e()})),l=[]}return p.setOptions(i).then((function(e){!d&&i.onFirstUpdate&&i.onFirstUpdate(e)})),p}}pn();var un,hn,cn,mn,fn,yn,Cn,gn,bn,vn=pn({defaultModifiers:[Ri,on,Li,pi,nn,Ki,sn,Ai,tn]});un=c.customElementOnce("rnwppages-dropdown-property"),hn=n.query("select"),un((cn=class extends pe{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Select",mn,this),this.multiple=!1,this.addRemoveButton=!1,this.PreviousOptions=[]}SubRender(){return o.html` <select ?multiple="${this.multiple}" value="${this.model.GetValue()}" style="width: 100%;max-width: 100%;display: none;"> <option></option> ${b.repeat(this.model.Items,(e=>e.Value),(e=>o.html`<option ?selected="${this.IsSelected(e.Value)}" .value="${e.Value}">${e.Label}</option>`))} </select> `}updated(e){if(this.PreviousOptions.length!=this.model.Items.length||this.model.Items.some((e=>this.PreviousOptions.indexOf(e.Value)<0))){this.TomSelect.clear(!0),this.TomSelect.clearOptions();for(let e of this.model.Items)this.TomSelect.addOption({value:e.Value,text:e.Label});this.PreviousOptions=this.model.Items.map((e=>e.Value));let e=this.model.GetValue();Array.isArray(e)||(e=[e]);for(let t of e)this.TomSelect.addItem(t,!0)}if(null!=this.TomSelect){let e=this.model.GetValue();Array.isArray(e)||this.TomSelect.getValue()==e||this.TomSelect.setValue(e,!0)}}firstUpdated(e){super.firstUpdated(e),this.PreviousOptions=this.model.Items.map((e=>e.Value));let t=[];(this.multiple||this.addRemoveButton)&&t.push("remove_button"),this.TomSelect=new TomSelect(this.Select,{plugins:t,onDropdownOpen:e=>{let t=this.TomSelect.control.getBoundingClientRect();e.style.position="absolute",e.style.zIndex="10000000000000000000000",e.style.width=t.width+"px",vn(this.TomSelect.control,e,{modifiers:[{name:"offset",options:{offset:[0,2]}}]})},onChange:e=>{this.model.SetValue(e)},dropdownParent:document.body})}IsSelected(e){return this.multiple?this.model.GetValue().indexOf(e)>=0:this.model.GetValue()==e}},mn=babelHelpers.applyDecoratedDescriptor(cn.prototype,"Select",[hn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cn));class On extends Pt{constructor(e,t,i){super(e,t,i),this.Items=[],this.PlaceHolder="Select..",this._multiple=!1}SetPlaceHolder(e){return this.PlaceHolder=e,this}SetIsMultiple(e=!0){return this._multiple=e,this}Render(){return o.html`<rnwppages-dropdown-property .multiple="${this._multiple}" .model="${this}"></rnwppages-dropdown-property>`}AddItem(e,t){return this.CreateItem(e,t),this}GetItems(){return this.Items}CreateItem(e,t){let i=new wn(this,e,t);return this.Items.push(i),i}}class wn{constructor(e,t,i){this.DropDown=e,this.Label=t,this.Value=i}}class Sn extends de{GetSettings(){return[this.CreateSetting("Mark as",new On(this,"ChangeTo","").AddItem("Read","read").AddItem("Unread","unread"))]}GetTitle(){return"Change Status"}}class In extends de{GetSettings(){return[this.CreateSetting("Change to",new On(this,"ChangeTo","").AddItem("Star","star").AddItem("No star","nostar"))]}GetTitle(){return"Change Status"}}n.customElement("rnwppages-text-property")(class extends pe{constructor(...e){super(...e),this.LatestObjectToUse=null}SubRender(){return o.html` <rn-text-editor style="height:200px" .value="${this.model.GetValue()}" .nodes="${[new s.ImageNode]}" @change="${e=>this.model.SetValue(e.detail)}"> </rn-text-editor> `}update(e){super.update(e),this.LatestModel!=this.model&&(this.MaybeUnsubscribe(),this.LatestModel=this.model.Element,this.MaybeSubscribe())}IsStoreBase(){if(null!=this.model.Element.Options&&null!=this.model.Element.Options.ValueChanged)return!0}MaybeUnsubscribe(){this.IsStoreBase()&&this.model.Element.Options.Unsubscribe(this)}MaybeSubscribe(){this.IsStoreBase()&&this.model.Element.Options.Subscribe(this,(e=>{e==this.model.PropertyName&&this.forceUpdate()}))}});class Tn extends Pt{constructor(e,t,i){super(e,t,i),this.ActivateChangeWhenBlur=!1}SetActivateChangeWhenBlur(){return this.ActivateChangeWhenBlur=!0,this}Render(){return o.html` <rnwppages-text-property .model="${this}"></rnwppages-text-property> `}}class xn extends de{GetSettings(){return[this.CreateSetting("Note Type",new On(this,"NoteType","").AddItem("Note","note").AddItem("Log","log")),this.CreateSetting("Status",new Tn(this,"Note",""))]}GetTitle(){return"Change Status"}}class $n extends E{LoadDefaultValues(){super.LoadDefaultValues(),this.Type="read_unread",this.ChangeTo="read"}}let Vn=(fn=e.StoreDataType(Object),yn=e.StoreDataType(String),Cn=class extends E{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Message",gn,this),babelHelpers.initializerDefineProperty(this,"Fields",bn,this)}LoadDefaultValues(){super.LoadDefaultValues(),this.Type="cancel_submission",this.Message=null,this.ErrorLocation="Footer",this.Fields=[]}},gn=babelHelpers.applyDecoratedDescriptor(Cn.prototype,"Message",[fn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bn=babelHelpers.applyDecoratedDescriptor(Cn.prototype,"Fields",[yn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cn);var Nn,An,En,Gn,Dn,Ln,Pn;Nn=c.customElementOnce("rnautomation-field-picker-property"),An=n.query("select"),Nn((En=class extends pe{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Select",Gn,this),this.multiple=!1,this.addRemoveButton=!1,this.PreviousOptions=[]}SubRender(){var e,t;let i=null===(e=this.model.Element.AutomationBuilder)||void 0===e||null===(t=e.DataSource)||void 0===t?void 0:t.GetFields();return o.html` <select ?multiple="${this.multiple}" value="${this.model.GetValue()}" style="width: 100%;max-width: 100%;display: none;"> <option></option> ${b.repeat(i,(e=>o.html`<option ?selected="${this.IsSelected(e.Id)}" .value="${e.Id}">${e.Label}</option>`))} </select> `}updated(e){if(this.PreviousOptions.length!=this.model.Items.length||this.model.Items.some((e=>this.PreviousOptions.indexOf(e.Value)<0))){this.TomSelect.clear(!0),this.TomSelect.clearOptions();for(let e of this.model.Items)this.TomSelect.addOption({value:e.Value,text:e.Label});this.PreviousOptions=this.model.Items.map((e=>e.Value));let e=this.model.GetValue();Array.isArray(e)||(e=[e]);for(let t of e)this.TomSelect.addItem(t,!0)}if(null!=this.TomSelect){let e=this.model.GetValue();Array.isArray(e)||this.TomSelect.getValue()==e||this.TomSelect.setValue(e,!0)}}firstUpdated(e){super.firstUpdated(e),this.PreviousOptions=this.model.Items.map((e=>e.Value));let t=[];(this.multiple||this.addRemoveButton)&&t.push("remove_button"),this.TomSelect=new TomSelect(this.Select,{plugins:t,onDropdownOpen:e=>{let t=this.TomSelect.control.getBoundingClientRect();e.style.position="absolute",e.style.zIndex="10000000000000000000000",e.style.width=t.width+"px",vn(this.TomSelect.control,e,{modifiers:[{name:"offset",options:{offset:[0,2]}}]})},onChange:e=>{this.model.SetValue(e)},dropdownParent:document.body})}IsSelected(e){return this.multiple?this.model.GetValue().indexOf(e)>=0:this.model.GetValue()==e}},Gn=babelHelpers.applyDecoratedDescriptor(En.prototype,"Select",[An],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),En));class Rn extends Pt{constructor(e,t,i){super(e,t,i),this.Items=[],this.PlaceHolder="Select..",this._multiple=!1}SetPlaceHolder(e){return this.PlaceHolder=e,this}SetIsMultiple(e=!0){return this._multiple=e,this}Render(){return o.html`<rnautomation-field-picker-property .multiple="${this._multiple}" .model="${this}"></rnautomation-field-picker-property>`}AddItem(e,t){return this.CreateItem(e,t),this}GetItems(){return this.Items}CreateItem(e,t){let i=new wn(this,e,t);return this.Items.push(i),i}}class Fn extends de{GetSettings(){let e=[this.CreateSetting("Message",new Rt(this,"Message","")),this.CreateSetting("Error Location",new On(this,"ErrorLocation","").AddItem("Footer","Footer").AddItem("Header","Header").AddItem("Field","Field").SetRefreshPropertiesPanel())];return"Field"==this.Options.ErrorLocation&&e.push(this.CreateSetting("Fields where the error will be shown",new Rn(this,"Fields","").SetIsMultiple(!0))),e}GetTitle(){return"Cancel Submission"}InitializeOptionsForFirstTime(){super.InitializeOptionsForFirstTime(),this.Options.Message={type:"doc",content:[{type:"paragraph",attrs:{align:null},content:[{type:"text",text:"Submission was cancelled "}]}]}}}class Mn extends de{GetSettings(){return[this.CreateSetting("Message",new Rt(this,"Message",""))]}GetTitle(){return"Cancel Submission"}InitializeOptionsForFirstTime(){super.InitializeOptionsForFirstTime(),this.Options.Message={type:"doc",content:[{type:"paragraph",attrs:{align:null},content:[{type:"text",text:"Deletion was cancelled "}]}]}}}class zn extends de{GetSettings(){return[this.CreateSetting("Message",new Rt(this,"Message",""))]}GetTitle(){return"Cancel Submission"}InitializeOptionsForFirstTime(){super.InitializeOptionsForFirstTime(),this.Options.Message={type:"doc",content:[{type:"paragraph",attrs:{align:null},content:[{type:"text",text:"Update was cancelled "}]}]}}}let Bn=(Dn=e.StoreDataType(Object),Ln=class extends E{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Message",Pn,this)}LoadDefaultValues(){super.LoadDefaultValues(),this.Type="cancel_delete",this.Message=null}},Pn=babelHelpers.applyDecoratedDescriptor(Ln.prototype,"Message",[Dn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ln);var Un,Hn,_n;let kn=(Un=e.StoreDataType(Object),Hn=class extends E{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Message",_n,this)}LoadDefaultValues(){super.LoadDefaultValues(),this.Type="cancel_update",this.Message=null}},_n=babelHelpers.applyDecoratedDescriptor(Hn.prototype,"Message",[Un],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hn);class qn{static GetActionArray(e){let t=[];for(let i of e)t.push(qn.GetAction(i));return t}static GetAction(e){let t=e;switch(null==e.Type?e=null:t=e.Type,t){case"send_email":return(new Y).Merge(e);case"update_entry":return(new re).Merge(e);case"change_status":return(new le).Merge(e);case"read_unread":return(new $n).Merge(e);case"star_unstar":return(new kt).Merge(e);case"add_note":return(new qt).Merge(e);case"cancel_submission":return(new Vn).Merge(e);case"cancel_delete":return(new Bn).Merge(e);case"cancel_update":return(new kn).Merge(e);default:return I.EventManager.Publish("GetAutomationActionOptions",{Type:t,Options:e})}}static GetModel(e,t){switch((e=qn.GetAction(e)).Type){case"send_email":return new Bt(e,t);case"update_entry":return new Ht(e,t);case"change_status":return new _t(e,t);case"read_unread":return new Sn(e,t);case"star_unstar":return new In(e,t);case"add_note":return new xn(e,t);case"cancel_submission":return new Fn(e,t);case"cancel_delete":return new Mn(e,t);case"cancel_update":return new zn(e,t);default:return I.EventManager.Publish("GetAutomationActionModel",{Options:e,Automation:t})}}}class jn{constructor(e,t=""){this.Id=e,this.Name=t,this.Fields=[]}AddField(e){this.Fields.push(e)}}class Wn extends ut{get UseInConditions(){return!1}}var Xn,Qn,Jn,Yn,Kn,Zn,eo,to,io;let no=(Xn=e.StoreDataType(String),Qn=class extends e.StoreBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Path",Jn,this)}LoadDefaultValues(){this.Id="",this.Label="",this.AddCommaBefore=!1,this.Path=[]}},Jn=babelHelpers.applyDecoratedDescriptor(Qn.prototype,"Path",[Xn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qn),oo=(Yn=e.StoreDataType(no),Kn=class extends e.StoreBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Items",Zn,this)}LoadDefaultValues(){this.Items=[]}},Zn=babelHelpers.applyDecoratedDescriptor(Kn.prototype,"Items",[Yn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kn),so=(eo=e.StoreDataType(oo),to=class extends ut{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Rows",io,this)}LoadDefaultValues(){super.LoadDefaultValues(),this.Rows=[]}GetDataSections(){let e=[{Id:this.Id,Label:this.Label+" (Id:"+this.Id+")",Path:["Value"],PathId:"Value"}],t=[];this.Rows.forEach((e=>t=t.concat(e.Items)));for(let i of t)e.push({Id:this.Id,Label:i.Label,Path:["Raw",...i.Path],PathId:i.Id});return e}},io=babelHelpers.applyDecoratedDescriptor(to.prototype,"Rows",[eo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),to);class ao extends ut{constructor(...e){super(...e),this.IsPR=!1,this.Column=""}get UseInConditions(){return!0}GetDataSections(e){return[{Id:this.Id,Label:this.Label+" (Id:"+this.Id+")",PathId:"Value",Path:["Value"]}]}LoadDefaultValues(){this.Id="",this.Label="",this.Type=He.None,this.SubType="",this.IsPR=!1}}var ro,lo,po;let uo=(ro=e.StoreDataType(ht),lo=class extends ct{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Items",po,this)}LoadDefaultValues(){super.LoadDefaultValues(),this.Items=[]}},po=babelHelpers.applyDecoratedDescriptor(lo.prototype,"Items",[ro],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lo);var ho,co,mo,fo,yo;let Co=(ho=e.StoreDataType(String),co=e.StoreDataType(String),mo=class extends ut{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Columns",fo,this),babelHelpers.initializerDefineProperty(this,"Rows",yo,this)}LoadDefaultValues(){super.LoadDefaultValues(),this.Rows=[],this.Columns=[]}get UseInConditions(){return!1}},fo=babelHelpers.applyDecoratedDescriptor(mo.prototype,"Columns",[ho],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yo=babelHelpers.applyDecoratedDescriptor(mo.prototype,"Rows",[co],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mo);class go extends ut{get UseInConditions(){return!1}}class bo{static GetField(e){switch(e.Type){case He.Text:case He.None:case He.User:case He.Toggle:case He.Time:return(new ut).Merge(e);case He.Number:case He.Rating:return(new ut).Merge(e);case He.Multiple:return(new ct).Merge(e);case He.FileUpload:return(new Wn).Merge(e);case He.DateTime:case He.List:return(new ut).Merge(e);case He.Composed:return(new so).Merge(e);case He.HTML:case He.Date:case He.EntryId:return(new ut).Merge(e);case He.Signature:return(new go).Merge(e);case He.Currency:return(new ao).Merge(e);case He.CurrencyMultiple:return(new uo).Merge(e);case He.LikertScale:return(new Co).Merge(e);default:throw new Error("Unknown field "+e.Type)}}}var vo,Oo,wo,So,Io;let To=(vo=c.customElementOnce("rnwppages-dropdown-property"),Oo=n.query("select"),vo((So=class extends pe{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Select",Io,this),this.multiple=!1,this.addRemoveButton=!1,this.PreviousOptions=[]}SubRender(){return o.html` <select ?multiple="${this.multiple}" value="${this.model.GetValue()}" style="width: 100%;max-width: 100%;display: none;"> <option></option> ${b.repeat(this.model.Items,(e=>e.Value),(e=>o.html`<option ?selected="${this.IsSelected(e.Value)}" .value="${e.Value}">${e.Label}</option>`))} </select> `}updated(e){if(this.PreviousOptions.length!=this.model.Items.length||this.model.Items.some((e=>this.PreviousOptions.indexOf(e.Value)<0))){this.TomSelect.clear(!0),this.TomSelect.clearOptions();for(let e of this.model.Items)this.TomSelect.addOption({value:e.Value,text:e.Label});this.PreviousOptions=this.model.Items.map((e=>e.Value));let e=this.model.GetValue();Array.isArray(e)||(e=[e]);for(let t of e)this.TomSelect.addItem(t,!0)}if(null!=this.TomSelect){let e=this.model.GetValue();Array.isArray(e)||this.TomSelect.getValue()==e||this.TomSelect.setValue(e,!0)}}firstUpdated(e){super.firstUpdated(e),this.PreviousOptions=this.model.Items.map((e=>e.Value));let t=[];(this.multiple||this.addRemoveButton)&&t.push("remove_button"),this.TomSelect=new TomSelect(this.Select,{plugins:t,onDropdownOpen:e=>{let t=this.TomSelect.control.getBoundingClientRect();e.style.position="absolute",e.style.zIndex="10000000000000000000000",e.style.width=t.width+"px",vn(this.TomSelect.control,e,{modifiers:[{name:"offset",options:{offset:[0,2]}}]})},onChange:e=>{this.model.SetValue(e)},dropdownParent:document.body})}IsSelected(e){return this.multiple?this.model.GetValue().indexOf(e)>=0:this.model.GetValue()==e}},Io=babelHelpers.applyDecoratedDescriptor(So.prototype,"Select",[Oo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wo=So))||wo);var xo,$o,Vo,No;xo=n.customElement("rn-inputs-user-select"),$o=n.query("select"),xo((Vo=class extends x.InputBase{constructor(...e){super(...e),this.placeholder="",this.valueField="",this.load=void 0,babelHelpers.initializerDefineProperty(this,"Select",No,this),this.createOnSpace=!1,this.Loaded=!0,this.onCustomizeItem=void 0,this.options=[]}static get properties(){return{value:{type:Object}}}SubRender(){return o.html` <select .placeholder="${"Search by role, user email or name"}" ?multiple="${this.multiple}" value="${this.GetValueFromOptions()}" style="display:none;width: 100%;max-width: 100%;" @change="${e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.SetValueFromOptions()}}"></select> `}GetValueFromOptions(){if(null==this.TomSelect)return;let e=[],t=this.GetValue();Array.isArray(t)||(t=[t]);for(let i of t){let t=i;t=t.Type+"_"+t.Value;for(let i in this.TomSelect.options)this.TomSelect.options[i].Value==t&&e.push(t)}return this.multiple?e:e[0]}SetValueFromOptions(){let e=this.TomSelect.getValue();Array.isArray(e)||(e=[e]);let t=[];for(let i of e){let e=this.TomSelect.options[i];null!=e&&(null!=e.Item?t.push(e.Item):t.push(e.Value))}if(!this.multiple)return this.SetValue(t[0]);this.SetValue(t)}get multiple(){return this.hasAttribute("multiple")}update(e){if(this.hasUpdated&&(e.has("value")||0==e.size&&this.TomSelect.getValue()!=this.GetValueFromOptions())){this.TomSelect.clearOptions(),this.Loaded=!1;for(let e of this.GetOptions())this.TomSelect.addOption(e);this.TomSelect.setValue(this.GetValueFromOptions(),!0),this.Loaded=!0}super.update(e)}GetOptions(){return"function"==typeof this.options?this.options():this.options}firstUpdated(e){super.firstUpdated(e);let t=[];this.multiple&&t.push("remove_button"),this.Loaded=!1;let i={};null!=this.onCustomizeItem&&(i.item=this.onCustomizeItem),this.TomSelect=new TomSelect(this.Select,{valueField:"Value",labelField:"Label",searchField:"Label",load:this.load,options:this.GetOptions(),optgroups:[{value:"User",label:"Users"},{value:"Role",label:"Roles"}],optgroupField:"Type",plugins:t,placeholder:"Search by role, user email or name",hidePlaceholder:!0,create:null!=this.onCreate&&this.onCreate,render:i,createOnBlur:null!=this.onCreate,onItemAdd:(e,t)=>{this.Loaded&&null!=this.TomSelect.options[e]&&this.FireEvent("itemAdded",this.TomSelect.options[e])},onDropdownOpen:e=>{let t=this.TomSelect.control.getBoundingClientRect();e.style.position="absolute",e.style.zIndex="10000000000000000000000",e.style.width=t.width+"px",vn(this.TomSelect.control,e,{modifiers:[{name:"offset",options:{offset:[0,2]}}]})},dropdownParent:document.body}),this.TomSelect.control.style.minHeight=""==this.style.minHeight?"33.5px":this.style.minHeight,this.createOnSpace&&this.TomSelect.control_input.addEventListener("keydown",(e=>{if(" "==e.key){let t=e.target.value;this.TomSelect.createItem(t,!0),this.TomSelect.addItem(t,!0)}})),this.TomSelect.setValue(this.GetValueFromOptions(),!0),this.Loaded=!0}},No=babelHelpers.applyDecoratedDescriptor(Vo.prototype,"Select",[$o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vo));var Ao={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="user",i=[128100,62144],n="f007",o="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0S96 57.3 96 128s57.3 128 128 128zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z";e.definition={prefix:"fas",iconName:t,icon:[448,512,i,n,o]},e.faUser=e.definition,e.prefix="fas",e.iconName=t,e.width=448,e.height=512,e.ligatures=i,e.unicode=n,e.svgPathData=o,e.aliases=i}(Ao);var Eo={};function Go(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="users",i=[],n="f0c0",o="M144 160c-44.2 0-80-35.8-80-80S99.8 0 144 0s80 35.8 80 80s-35.8 80-80 80zm368 0c-44.2 0-80-35.8-80-80s35.8-80 80-80s80 35.8 80 80s-35.8 80-80 80zM0 298.7C0 239.8 47.8 192 106.7 192h42.7c15.9 0 31 3.5 44.6 9.7c-1.3 7.2-1.9 14.7-1.9 22.3c0 38.2 16.8 72.5 43.3 96c-.2 0-.4 0-.7 0H21.3C9.6 320 0 310.4 0 298.7zM405.3 320c-.2 0-.4 0-.7 0c26.6-23.5 43.3-57.8 43.3-96c0-7.6-.7-15-1.9-22.3c13.6-6.3 28.7-9.7 44.6-9.7h42.7C592.2 192 640 239.8 640 298.7c0 11.8-9.6 21.3-21.3 21.3H405.3zM416 224c0 53-43 96-96 96s-96-43-96-96s43-96 96-96s96 43 96 96zM128 485.3C128 411.7 187.7 352 261.3 352H378.7C452.3 352 512 411.7 512 485.3c0 14.7-11.9 26.7-26.7 26.7H154.7c-14.7 0-26.7-11.9-26.7-26.7z";e.definition={prefix:"fas",iconName:t,icon:[640,512,i,n,o]},e.faUsers=e.definition,e.prefix="fas",e.iconName=t,e.width=640,e.height=512,e.ligatures=i,e.unicode=n,e.svgPathData=o,e.aliases=i}(Eo),n.customElement("rnwppages-user-property")(class extends pe{constructor(){super(),this.LoadUsers=this.LoadUsers.bind(this)}SubRender(){let e=this.GetSanitizedValue();return Array.isArray(e)||(e=[e]),Ct.GetInstance().HasAllUsers(e.filter((e=>"User"==e.Type)).map((e=>e.Value)))?o.html` <rn-inputs-user-select .onCustomizeItem="${(e,t)=>this.RenderItem(e,t)}" .load="${this.LoadUsers}" style="min-height: 30px" ?multiple="${this.model.multiple}" .value="${this.GetSanitizedValue()}" @change="${e=>{this.ValueChanged(e)}}" .options="${[...Ct.GetInstance().GetUserList().map((e=>({Type:"User",Value:"User_"+e.Value,Label:e.Label,Item:{Type:"User",Value:e.Value}}))),...this.model.includeGroups?rnBuilderVar.Roles.map((e=>({Item:{Type:"Role",Value:e.Id},Type:"Role",Label:e.Label,Value:"Role_"+e.Id}))):[]]}" .propertyName="${"Type"}"></rn-inputs-user-select> `:(Ct.GetInstance().GetUsersById(e.filter((e=>"User"==e.Type)).map((e=>e.Value))).then((e=>this.model.Refresh())),o.html`<span>Loading users</span>`)}GetSanitizedValue(){if(this.model.includeGroups)return this.model.GetValue();let e=this.model.GetValue();return null==e?[]:(Array.isArray(e)||(e=[e]),e.map((e=>({Type:"User",Value:e,Item:{Type:"User",Value:e}}))))}ValueChanged(e){null!=e.detail&&(null==e.detail&&this.model.SetValue(e.detail),this.model.includeGroups?this.model.SetValue(e.detail):Array.isArray(e.detail)?this.model.SetValue(e.detail.map((e=>e.Value))):this.model.SetValue(e.detail.Value))}RenderItem(e,t){let i=null;return i="User"==e.Item.Type?Ao.faUser:Eo.faUsers,o.renderInline(o.html`<div><rn-fontawesome .icon="${i}" style="margin-right: 3px"></rn-fontawesome> ${e.Label}</div>`)}async LoadUsers(e,t){let i=await v.WpAjaxPost.Post("list_users",{query:e},"",null,{Nonce:rnBuilderVar._nonce,Prefix:rnBuilderVar._prefix});if(null!=i)for(let e of i)Ct.GetInstance().AddUser(e.Value,e.Label);let n=i.map((e=>function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Go(Object(i),!0).forEach((function(t){babelHelpers.defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Go(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},e,{Type:"User",Item:{Type:"User",Value:e.Value},Value:"User_"+e.Value})));this.model.includeGroups&&rnBuilderVar.Roles.filter((t=>t.Label.toLowerCase().includes(e.toLowerCase()))).forEach((e=>n.push({Item:{Type:"Role",Value:e.Id},Label:e.Label,Type:"Role",Value:"Role_"+e.Id}))),t(n)}});n.customElement("rn-accordion-property")(class extends pe{constructor(...e){super(...e),this.SelectedTab=null}static get properties(){return{SelectedTab:{type:String}}}SubRender(){return null===this.SelectedTab&&this.model.Tabs.length>0&&(this.SelectedTab=this.model.Tabs[0].Label),o.html`<rn-tabs .selectedTab="${this.SelectedTab}" @tabChanged="${e=>this.SelectedTab=e.detail}" .tabs="${this.model.Tabs.map((e=>new $.RNTabItem(e.Label,e.Label,e.Icon,o.html` ${b.repeat(e.Properties,(e=>e.Label),(e=>e.Render()))} `)))}"> </rn-tabs>`}});class Do{constructor(e,t=null){this.Label=e,this.Icon=t,this.Properties=[]}AddProperty(e){this.Properties.push(e)}}var Lo=[{Type:"send_email",Title:"Send Email",Description:"Configure an email that is sent when this action is executed.",AllowedTriggers:["*"]},{Type:"change_status",Title:Ye.AddFullVersionText("Update Status"),Description:"Update the status of the entry.",AllowedTriggers:["form_submitted","entry_updated"]},{Type:"update_entry",Title:Ye.AddFullVersionText("Update Entry"),Description:"Update any field of the entry.",AllowedTriggers:["form_submitted","entry_updated"]},{Type:"read_unread",Title:Ye.AddFullVersionText("Read/Unread"),Description:"Mark entry as read/unread.",AllowedTriggers:["form_submitted","entry_updated"]},{Type:"star_unstar",Title:Ye.AddFullVersionText("Star/Unstar"),Description:"Star/Unstar entry.",AllowedTriggers:["form_submitted","entry_updated"]},{Type:"add_note",Title:Ye.AddFullVersionText("Add note"),Description:"Add a note to the entry.",AllowedTriggers:["form_submitted","entry_updated"]},{Type:"cancel_submission",Title:"Cancel submission",Description:"Cancel the submission of the form",AllowedTriggers:["before_submit"]},{Type:"cancel_update",Title:"Cancel update",Description:"",AllowedTriggers:["before_update"]},{Type:"cancel_delete",Title:"Cancel delete",Description:"",AllowedTriggers:["before_delete"]}];c.customElementOnce("rnwppages-license-required")(class extends u.DialogBase{constructor(...e){super(...e),this.message=""}InternalGetOptions(){return{Title:"Full version required",ShowApplyButton:!0,ShowCloseButton:!0,CloseButtonTitle:"Close",ApplyButtonTitle:"Get Full Version"}}SubRender(){return o.html`${this.message}`}async OnApply(){return window.open("https://formwiz.rednao.com/downloads/automation-for-wpforms/"),!0}static IsValid(e="Sorry this feature is only available in the full version"){return"1"==rnBuilderVar.IsPR||(p.Dialog.Show(o.html`<rnwppages-license-required .message="${e}"></rnwppages-license-required>`),!1)}static AddFullVersionText(e){return""==rnBuilderVar.IsPR?e+" (Full version only)":e}}),exports.ActionFactory=qn,exports.EditEntryPropertyModel=Ut,exports.NoneAction=class extends de{GetTitle(){return"None"}},exports.ActionBaseOptions=E,exports.ActionDictionary={},exports.ActionDictionary.ActionDictionary=Lo,exports.ActionDictionary.GetActionsByTrigger=function(e){return Lo.filter((t=>t.AllowedTriggers.indexOf("*")>=0||t.AllowedTriggers.indexOf(e)>=0))},exports.EmailActionOptions={},exports.EmailActionOptions.EmailAddress=J,exports.EmailActionOptions.EmailAddressEnum=X,exports.ActionBaseModel=de,exports.DropdownPropertyModel=On,exports.DropdownProperty=To,exports.ConditionBuilderModel=At,exports.ConditionGroupOptions=Pe,exports.ConditionBaseOptions=je,exports.DataSource=class{constructor(e){this.Model=e,this.Forms=[],this.InitializeForms()}GetFormList(){return this.Forms}GetForm(){return this.GetFormById(this.Model.Options.FormId)}GetFields(){var e;return null===(e=this.GetForm())||void 0===e?void 0:e.Fields}GetFormById(e){return this.Forms.find((t=>t.Id==e))}GetFriendlyName(e,t="Value",i=!1,n=!1,o=""){let s=this.GetFieldById(e,o);if(null==s)return"";let a="";if("Value"==t||null==t)a=s.Label;else{let e=s.GetDataSections("Display").find((e=>e.PathId==t));if(null==e)return"";a=e.Label}return i&&(a=s.Id+": "+a),n&&(a="["+a+"]"),a}GetFieldById(e,t=""){let i=this.GetForm();return""!=t&&(i=this.GetFormById(t)),null==i?null:i.Fields.find((t=>t.Id==e))}InitializeForms(){for(let e of rnBuilderVar.FormList){let t=new jn(e.Id);for(let i of e.Fields)t.AddField(bo.GetField(i));this.Forms.push(t)}}GetPDFTemplates(){return[]}},exports.CheckboxPropertyModel=class extends Pt{constructor(e,t,i){super(e,t,i)}Render(){return o.html`<rnwppages-checkbox-property .model="${this}"></rnwppages-checkbox-property>`}},exports.EmailPropertyModel=Rt,exports.DataSourceForm=jn,exports.UserPropertyModel=class extends Pt{constructor(...e){super(...e),this.AllowMultiple=!1,this.multiple=!1}Render(){return o.html`<rnwppages-user-property .model="${this}"></rnwppages-user-property>`}SetAllowMultiple(e){return this.AllowMultiple=e,this}SetIncludeGroups(){return this.includeGroups=!0,this}SetMultiple(){return this.multiple=!0,this}},exports.AccordionPropertyModel=class extends Pt{constructor(e,t=""){super(e,"",t),this.Tabs=[]}Render(){return o.html`<rn-accordion-property .model="${this}"></rn-accordion-property>`}CreateTab(e,t=null){let i=new Do(e,t);return this.Tabs.push(i),i}},exports.TextWithTagsPropertyModel=Ft,exports.SimpleTextPropertyModel=Mt,exports.EmailAction=Bt,exports.EmailAddressEnum=X,exports.EmailAddressPropertyModel=zt,exports.LicenseRequired=Ye}));
